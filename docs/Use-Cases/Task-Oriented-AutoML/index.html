<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v0.0.0-4193">
<link rel="alternate" type="application/rss+xml" href="/FLAML/blog/rss.xml" title="FLAML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/FLAML/blog/atom.xml" title="FLAML Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Task Oriented AutoML | FLAML</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://microsoft.github.io//FLAML/docs/Use-Cases/Task-Oriented-AutoML"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Task Oriented AutoML | FLAML"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/FLAML/img/flaml_logo.ico"><link data-react-helmet="true" rel="canonical" href="https://microsoft.github.io//FLAML/docs/Use-Cases/Task-Oriented-AutoML"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io//FLAML/docs/Use-Cases/Task-Oriented-AutoML" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io//FLAML/docs/Use-Cases/Task-Oriented-AutoML" hreflang="x-default"><link rel="stylesheet" href="/FLAML/assets/css/styles.a35b243d.css">
<link rel="preload" href="/FLAML/assets/js/runtime~main.597cf7c4.js" as="script">
<link rel="preload" href="/FLAML/assets/js/main.ced98023.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/FLAML/"><div class="navbar__logo"><img src="/FLAML/img/flaml_logo_fill.svg" alt="FLAML" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/FLAML/img/flaml_logo_fill.svg" alt="FLAML" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">FLAML</b></a><a class="navbar__item navbar__link navbar__link--active" href="/FLAML/docs/Getting-Started">Docs</a><a class="navbar__item navbar__link" href="/FLAML/docs/reference/automl/automl">SDK</a><a class="navbar__item navbar__link" href="/FLAML/blog">Blog</a><a class="navbar__item navbar__link" href="/FLAML/docs/FAQ">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/FLAML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Getting-Started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Use Cases</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Use-Cases/Autogen">AutoGen for Large Language Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/FLAML/docs/Use-Cases/Task-Oriented-AutoML">Task Oriented AutoML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function">Tune User Defined Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Use-Cases/Zero-Shot-AutoML">Zero Shot AutoML</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Contribute">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Research">Research</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Task Oriented AutoML</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="overview">Overview<a aria-hidden="true" class="hash-link" href="#overview" title="Direct link to heading">â€‹</a></h2><p><a href="/FLAML/docs/reference/automl/automl#automl-objects"><code>flaml.AutoML</code></a> is a class for task-oriented AutoML. It can be used as a scikit-learn style estimator with the standard <code>fit</code> and <code>predict</code> functions. The minimal inputs from users are the training data and the task type.</p><ul><li>Training data:<ul><li>numpy array. When the input data are stored in numpy array, they are passed to <code>fit()</code> as <code>X_train</code> and <code>y_train</code>.</li><li>pandas dataframe. When the input data are stored in pandas dataframe, they are passed to <code>fit()</code> either as <code>X_train</code> and <code>y_train</code>, or as <code>dataframe</code> and <code>label</code>.</li></ul></li><li>Tasks (specified via <code>task</code>):<ul><li>&#x27;classification&#x27;: classification with tabular data.</li><li>&#x27;regression&#x27;: regression with tabular data.</li><li>&#x27;ts_forecast&#x27;: time series forecasting.</li><li>&#x27;ts_forecast_classification&#x27;: time series forecasting for classification.</li><li>&#x27;ts_forecast_panel&#x27;: time series forecasting for panel datasets (multiple time series).</li><li>&#x27;rank&#x27;: learning to rank.</li><li>&#x27;seq-classification&#x27;: sequence classification.</li><li>&#x27;seq-regression&#x27;: sequence regression.</li><li>&#x27;summarization&#x27;: text summarization.</li><li>&#x27;token-classification&#x27;: token classification.</li><li>&#x27;multichoice-classification&#x27;: multichoice classification.</li></ul></li></ul><p>Two optional inputs are <code>time_budget</code> and <code>max_iter</code> for searching models and hyperparameters. When both are unspecified, only one model per estimator will be trained (using our <a href="/FLAML/docs/Use-Cases/Zero-Shot-AutoML">zero-shot</a> technique). When <code>time_budget</code> is provided, there can be randomness in the result due to runtime variance.</p><p>A typical way to use <code>flaml.AutoML</code>:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Prepare training data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> task</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;regression&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> time_budget</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">60</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">other_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Save the model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">open</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;automl.pkl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;wb&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pickle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dump</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> pickle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">HIGHEST_PROTOCOL</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># At prediction time</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">open</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;automl.pkl&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rb&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> pickle</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">f</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If users provide the minimal inputs only, <code>AutoML</code> uses the default settings for optimization metric, estimator list etc.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="customize-automlfit">Customize AutoML.fit()<a aria-hidden="true" class="hash-link" href="#customize-automlfit" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="optimization-metric">Optimization metric<a aria-hidden="true" class="hash-link" href="#optimization-metric" title="Direct link to heading">â€‹</a></h3><p>The optimization metric is specified via the <code>metric</code> argument. It can be either a string which refers to a built-in metric, or a user-defined function.</p><ul><li>Built-in metric.<ul><li>&#x27;accuracy&#x27;: 1 - accuracy as the corresponding metric to minimize.</li><li>&#x27;log_loss&#x27;: default metric for multiclass classification.</li><li>&#x27;r2&#x27;: 1 - r2_score as the corresponding metric to minimize. Default metric for regression.</li><li>&#x27;rmse&#x27;: root mean squared error.</li><li>&#x27;mse&#x27;: mean squared error.</li><li>&#x27;mae&#x27;: mean absolute error.</li><li>&#x27;mape&#x27;: mean absolute percentage error.</li><li>&#x27;roc_auc&#x27;: minimize 1 - roc_auc_score. Default metric for binary classification.</li><li>&#x27;roc_auc_ovr&#x27;: minimize 1 - roc_auc_score with <code>multi_class=&quot;ovr&quot;</code>.</li><li>&#x27;roc_auc_ovo&#x27;: minimize 1 - roc_auc_score with <code>multi_class=&quot;ovo&quot;</code>.</li><li>&#x27;roc_auc_weighted&#x27;: minimize 1 - roc_auc_score with <code>average=&quot;weighted&quot;</code>.</li><li>&#x27;roc_auc_ovr_weighted&#x27;: minimize 1 - roc_auc_score with <code>multi_class=&quot;ovr&quot;</code> and <code>average=&quot;weighted&quot;</code>.</li><li>&#x27;roc_auc_ovo_weighted&#x27;: minimize 1 - roc_auc_score with <code>multi_class=&quot;ovo&quot;</code> and <code>average=&quot;weighted&quot;</code>.</li><li>&#x27;f1&#x27;: minimize 1 - f1_score.</li><li>&#x27;micro_f1&#x27;: minimize 1 - f1_score with <code>average=&quot;micro&quot;</code>.</li><li>&#x27;macro_f1&#x27;: minimize 1 - f1_score with <code>average=&quot;macro&quot;</code>.</li><li>&#x27;ap&#x27;: minimize 1 - average_precision_score.</li><li>&#x27;ndcg&#x27;: minimize 1 - ndcg_score.</li><li>&#x27;ndcg@k&#x27;: minimize 1 - ndcg_score@k. k is an integer.</li></ul></li><li>User-defined function.
A customized metric function that requires the following (input) signature, and returns the input configâ€™s value in terms of the metric you want to minimize, and a dictionary of auxiliary information at your choice:</li></ul><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">custom_metric</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    weight_val</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    weight_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    config</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    groups_val</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    groups_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> metric_to_minimize</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> metrics_to_log</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">custom_metric</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    weight_val</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    weight_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">metrics </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> log_loss</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    start </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict_proba</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    pred_time </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> start</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">len</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    val_loss </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> log_loss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_pred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> labels</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> sample_weight</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">weight_val</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict_proba</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    train_loss </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> log_loss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_pred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> labels</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">labels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> sample_weight</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">weight_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.5</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> val_loss </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> alpha</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> alpha </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> train_loss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;val_loss&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> val_loss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;train_loss&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> train_loss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;pred_time&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> pred_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>It returns the validation loss penalized by the gap between validation and training loss as the metric to minimize, and three metrics to log: val_loss, train_loss and pred_time. The arguments <code>config</code>, <code>groups_val</code> and <code>groups_train</code> are not used in the function.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="estimator-and-search-space">Estimator and search space<a aria-hidden="true" class="hash-link" href="#estimator-and-search-space" title="Direct link to heading">â€‹</a></h3><p>The estimator list can contain one or more estimator names, each corresponding to a built-in estimator or a custom estimator. Each estimator has a search space for hyperparameter configurations. FLAML supports both classical machine learning models and deep neural networks.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="estimator">Estimator<a aria-hidden="true" class="hash-link" href="#estimator" title="Direct link to heading">â€‹</a></h4><ul><li>Built-in estimator.<ul><li>&#x27;lgbm&#x27;: LGBMEstimator for task &quot;classification&quot;, &quot;regression&quot;, &quot;rank&quot;, &quot;ts_forecast&quot; and &quot;ts_forecast_classification&quot;. Hyperparameters: n_estimators, num_leaves, min_child_samples, learning_rate, log_max_bin (logarithm of (max_bin + 1) with base 2), colsample_bytree, reg_alpha, reg_lambda.</li><li>&#x27;xgboost&#x27;: XGBoostSkLearnEstimator for task &quot;classification&quot;, &quot;regression&quot;, &quot;rank&quot;, &quot;ts_forecast&quot; and &quot;ts_forecast_classification&quot;. Hyperparameters: n_estimators, max_leaves, min_child_weight, learning_rate, subsample, colsample_bylevel, colsample_bytree, reg_alpha, reg_lambda.</li><li>&#x27;xgb_limitdepth&#x27;: XGBoostLimitDepthEstimator for task &quot;classification&quot;, &quot;regression&quot;, &quot;rank&quot;, &quot;ts_forecast&quot; and &quot;ts_forecast_classification&quot;. Hyperparameters: n_estimators,  max_depth, min_child_weight, learning_rate, subsample, colsample_bylevel, colsample_bytree, reg_alpha, reg_lambda.</li><li>&#x27;rf&#x27;: RandomForestEstimator for task &quot;classification&quot;, &quot;regression&quot;, &quot;ts_forecast&quot; and &quot;ts_forecast_classification&quot;. Hyperparameters: n_estimators, max_features, max_leaves, criterion (for classification only). Starting from v1.1.0,
it uses a fixed random_state by default.</li><li>&#x27;extra_tree&#x27;: ExtraTreesEstimator for task &quot;classification&quot;, &quot;regression&quot;, &quot;ts_forecast&quot; and &quot;ts_forecast_classification&quot;. Hyperparameters: n_estimators, max_features, max_leaves, criterion (for classification only). Starting from v1.1.0,
it uses a fixed random_state by default.</li><li>&#x27;histgb&#x27;: HistGradientBoostingEstimator for task &quot;classification&quot;, &quot;regression&quot;, &quot;ts_forecast&quot; and &quot;ts_forecast_classification&quot;. Hyperparameters: n_estimators, max_leaves, min_samples_leaf, learning_rate, log_max_bin (logarithm of (max_bin + 1) with base 2), l2_regularization. It uses a fixed random_state by default.</li><li>&#x27;lrl1&#x27;: LRL1Classifier (sklearn.LogisticRegression with L1 regularization) for task &quot;classification&quot;. Hyperparameters: C.</li><li>&#x27;lrl2&#x27;: LRL2Classifier (sklearn.LogisticRegression with L2 regularization) for task &quot;classification&quot;. Hyperparameters: C.</li><li>&#x27;catboost&#x27;: CatBoostEstimator for task &quot;classification&quot; and &quot;regression&quot;. Hyperparameters: early_stopping_rounds, learning_rate, n_estimators.</li><li>&#x27;kneighbor&#x27;: KNeighborsEstimator for task &quot;classification&quot; and &quot;regression&quot;. Hyperparameters: n_neighbors.</li><li>&#x27;prophet&#x27;: Prophet for task &quot;ts_forecast&quot;. Hyperparameters: changepoint_prior_scale, seasonality_prior_scale, holidays_prior_scale, seasonality_mode.</li><li>&#x27;arima&#x27;: ARIMA for task &quot;ts_forecast&quot;. Hyperparameters: p, d, q.</li><li>&#x27;sarimax&#x27;: SARIMAX for task &quot;ts_forecast&quot;. Hyperparameters: p, d, q, P, D, Q, s.</li><li>&#x27;holt-winters&#x27;: Holt-Winters (triple exponential smoothing) model for task &quot;ts_forecast&quot;. Hyperparameters: seasonal_perdiods, seasonal, use_boxcox, trend, damped_trend.</li><li>&#x27;transformer&#x27;: Huggingface transformer models for task &quot;seq-classification&quot;, &quot;seq-regression&quot;, &quot;multichoice-classification&quot;, &quot;token-classification&quot; and &quot;summarization&quot;. Hyperparameters: learning_rate, num_train_epochs, per_device_train_batch_size, warmup_ratio, weight_decay, adam_epsilon, seed.</li><li>&#x27;temporal_fusion_transformer&#x27;: TemporalFusionTransformerEstimator for task &quot;ts_forecast_panel&quot;. Hyperparameters: gradient_clip_val, hidden_size, hidden_continuous_size, attention_head_size, dropout, learning_rate. There is a <a href="https://github.com/jdb78/pytorch-forecasting/issues/1145" target="_blank" rel="noopener noreferrer">known issue</a> with pytorch-forecast logging.</li></ul></li><li>Custom estimator. Use custom estimator for:<ul><li>tuning an estimator that is not built-in;</li><li>customizing search space for a built-in estimator.</li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="guidelines-on-tuning-a-custom-estimator">Guidelines on tuning a custom estimator<a aria-hidden="true" class="hash-link" href="#guidelines-on-tuning-a-custom-estimator" title="Direct link to heading">â€‹</a></h4><p>To tune a custom estimator that is not built-in, you need to:</p><ol><li>Build a custom estimator by inheritting <a href="/FLAML/docs/reference/automl/model#baseestimator-objects"><code>flaml.automl.model.BaseEstimator</code></a> or a derived class.
For example, if you have a estimator class with scikit-learn style <code>fit()</code> and <code>predict()</code> functions, you only need to set <code>self.estimator_class</code> to be that class in your constructor.</li></ol><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> SKLearnEstimator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># SKLearnEstimator is derived from BaseEstimator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> rgf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyRegularizedGreedyForest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">SKLearnEstimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> task</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;binary&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> task </span><span class="token keyword" style="font-style:italic">in</span><span class="token plain"> CLASSIFICATION</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> rgf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sklearn </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> RGFClassifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">estimator_class </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RGFClassifier</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">else</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> rgf</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sklearn </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> RGFRegressor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">estimator_class </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> RGFRegressor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@classmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">search_space</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        space </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_leaf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">lograndint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">data_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;low_cost_init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;n_iter&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">lograndint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">data_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;low_cost_init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;learning_rate&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">loguniform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.01</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">20.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;min_samples_leaf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">lograndint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> space</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the constructor, we set <code>self.estimator_class</code> as <code>RGFClassifier</code> or <code>RGFRegressor</code> according to the task type. If the estimator you want to tune does not have a scikit-learn style <code>fit()</code> and <code>predict()</code> API, you can override the <code>fit()</code> and <code>predict()</code> function of <code>flaml.automl.model.BaseEstimator</code>, like <a href="/FLAML/docs/reference/automl/model#xgboostestimator-objects">XGBoostEstimator</a>. Importantly, we also add the <code>task=&quot;binary&quot;</code> parameter in the signature of <code>__init__</code> so that it doesn&#x27;t get grouped together with the <code>**config</code> kwargs that determines the parameters with which the underlying estimator (<code>self.estimator_class</code>) is constructed. If your estimator doesn&#x27;t use one of the parameters that it is passed, for example some regressors in <code>scikit-learn</code> don&#x27;t use the <code>n_jobs</code> parameter, it is enough to add <code>n_jobs=None</code> to the signature so that it is ignored by the <code>**config</code> dict.</p><ol start="2"><li>Give the custom estimator a name and add it in AutoML. E.g.,</li></ol><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">add_learner</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rgf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> MyRegularizedGreedyForest</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This registers the <code>MyRegularizedGreedyForest</code> class in AutoML, with the name &quot;rgf&quot;.</p><ol start="3"><li>Tune the newly added custom estimator in either of the following two ways depending on your needs:</li></ol><ul><li>tune rgf alone: <code>automl.fit(..., estimator_list=[&quot;rgf&quot;])</code>; or</li><li>mix it with other built-in learners: <code>automl.fit(..., estimator_list=[&quot;rgf&quot;, &quot;lgbm&quot;, &quot;xgboost&quot;, &quot;rf&quot;])</code>.</li></ul><h4 class="anchor anchorWithStickyNavbar_y2LR" id="search-space">Search space<a aria-hidden="true" class="hash-link" href="#search-space" title="Direct link to heading">â€‹</a></h4><p>Each estimator class, built-in or not, must have a <code>search_space</code> function. In the <code>search_space</code> function, we return a dictionary about the hyperparameters, the keys of which are the names of the hyperparameters to tune, and each value is a set of detailed search configurations about the corresponding hyperparameters represented in a dictionary. A search configuration dictionary includes the following fields:</p><ul><li><code>domain</code>, which specifies the possible values of the hyperparameter and their distribution. Please refer to <a href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function#more-details-about-the-search-space-domain">more details about the search space domain</a>.</li><li><code>init_value</code> (optional), which specifies the initial value of the hyperparameter.</li><li><code>low_cost_init_value</code>(optional), which specifies the value of the hyperparameter that is associated with low computation cost. See <a href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function#cost-related-hyperparameters">cost related hyperparameters</a> or <a href="/FLAML/docs/FAQ#about-low_cost_partial_config-in-tune">FAQ</a> for more details.</li></ul><p>In the example above, we tune four hyperparameters, three integers and one float. They all follow a log-uniform distribution. &quot;max_leaf&quot; and &quot;n_iter&quot; have &quot;low_cost_init_value&quot; specified as their values heavily influence the training cost.</p><p>To customize the search space for a built-in estimator, use a similar approach to define a class that inherits the existing estimator. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> XGBoostEstimator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">logregobj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">preds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dtrain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    labels </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> dtrain</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get_label</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    preds </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">exp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">preds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># transform raw leaf weight</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    grad </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> preds </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> labels</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    hess </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> preds </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> preds</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> grad</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> hess</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MyXGB1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">XGBoostEstimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;XGBoostEstimator with logregobj as the objective function&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">objective</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">logregobj</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We override the constructor and set the training objective as a custom function <code>logregobj</code>. The hyperparameters and their search range do not change. For another example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">XGBoost2D</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">XGBoostSklearnEstimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@classmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">search_space</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">cls</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> task</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        upper </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">min</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">32768</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">int</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data_size</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;n_estimators&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">lograndint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">upper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;low_cost_init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_leaves&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">lograndint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">upper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">                </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;low_cost_init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We override the <code>search_space</code> function to tune two hyperparameters only, &quot;n_estimators&quot; and &quot;max_leaves&quot;. They are both random integers in the log space, ranging from 4 to data-dependent upper bound. The lower bound for each corresponds to low training cost, hence the &quot;low_cost_init_value&quot; for each is set to 4.</p><h5 class="anchor anchorWithStickyNavbar_y2LR" id="a-shortcut-to-override-the-search-space">A shortcut to override the search space<a aria-hidden="true" class="hash-link" href="#a-shortcut-to-override-the-search-space" title="Direct link to heading">â€‹</a></h5><p>One can use the <code>custom_hp</code> argument in <a href="/FLAML/docs/reference/automl/automl#fit"><code>AutoML.fit()</code></a> to override the search space for an existing estimator quickly. For example, if you would like to temporarily change the search range of &quot;n_estimators&quot; of xgboost, disable searching &quot;max_leaves&quot; in random forest, and add &quot;subsample&quot; in the search space of lightgbm, you can set:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">custom_hp </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;xgboost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;n_estimators&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">lograndint</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">new_lower</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">new_upper</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;low_cost_init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> new_lower</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_leaves&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">None</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># disable search</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lgbm&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subsample&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> tune</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">uniform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">lower</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> upper</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;init_value&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1.0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;subsample_freq&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># subsample_freq must &gt; 0 to enable subsample</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="constraint">Constraint<a aria-hidden="true" class="hash-link" href="#constraint" title="Direct link to heading">â€‹</a></h3><p>There are several types of constraints you can impose.</p><ol><li>Constraints on the AutoML process.</li></ol><ul><li><p><code>time_budget</code>: constrains the wall-clock time (seconds) used by the AutoML process. We provide some tips on <a href="#how-to-set-time-budget">how to set time budget</a>.</p></li><li><p><code>max_iter</code>: constrains the maximal number of models to try in the AutoML process.</p></li></ul><ol start="2"><li>Constraints on the constructor arguments of the estimators.</li></ol><p>Some constraints on the estimator can be implemented via the custom learner. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(255, 203, 107)">MonotonicXGBoostEstimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">XGBoostSklearnEstimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token decorator annotation punctuation" style="color:rgb(199, 146, 234)">@classmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">search_space</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        space </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(130, 170, 255)">super</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">search_space</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">args</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        space</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">update</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;monotone_constraints&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;(1, -1)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> space</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>It adds a monotonicity constraint to XGBoost. This approach can be used to set any constraint that is an argument in the underlying estimator&#x27;s constructor.
A shortcut to do this is to use the <a href="#a-shortcut-to-override-the-search-space"><code>custom_hp</code></a> argument:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">custom_hp </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;xgboost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;monotone_constraints&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;domain&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;(1, -1)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># fix the domain as a constant</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="3"><li>Constraints on the models tried in AutoML.</li></ol><p>Users can set constraints such as the maximal number of models to try, limit on training time and prediction time per model.</p><ul><li><code>train_time_limit</code>: training time in seconds.</li><li><code>pred_time_limit</code>: prediction time per instance in seconds.</li></ul><p>For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> max_iter</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> train_time_limit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> pred_time_limit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1e-3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol start="4"><li>Constraints on the metrics of the ML model tried in AutoML.</li></ol><p>When users provide a <a href="#optimization-metric">custom metric function</a>, which returns a primary optimization metric and a dictionary of additional metrics (typically also about the model) to log, users can also specify constraints on one or more of the metrics in the dictionary of additional metrics.</p><p>Users need to provide a list of such constraints in the following format:
Each element in this list is a 3-tuple, which shall be expressed
in the following format: the first element of the 3-tuple is the name of the
metric, the second element is the inequality sign chosen from &quot;&gt;=&quot; and &quot;\&lt;=&quot;,
and the third element is the constraint value. E.g., <code>(&#x27;val_loss&#x27;, &#x27;&lt;=&#x27;, 0.1)</code>.</p><p>For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">metric_constraints </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;train_loss&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;=&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;val_loss&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;&lt;=&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0.1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    max_iter</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">100</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    train_time_limit</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    metric_constraints</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">metric_constraints</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ensemble">Ensemble<a aria-hidden="true" class="hash-link" href="#ensemble" title="Direct link to heading">â€‹</a></h3><p>To use stacked ensemble after the model search, set <code>ensemble=True</code> or a dict. When <code>ensemble=True</code>, the final estimator and <code>passthrough</code> in the stacker will be automatically chosen. You can specify customized final estimator or passthrough option:</p><ul><li>&quot;final_estimator&quot;: an instance of the final estimator in the stacker.</li><li>&quot;passthrough&quot;: True (default) or False, whether to pass the original features to the stacker.</li></ul><p>For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> task</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ensemble&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;final_estimator&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> LogisticRegression</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;passthrough&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="resampling-strategy">Resampling strategy<a aria-hidden="true" class="hash-link" href="#resampling-strategy" title="Direct link to heading">â€‹</a></h3><p>By default, flaml decides the resampling automatically according to the data size and the time budget. If you would like to enforce a certain resampling strategy, you can set <code>eval_method</code> to be &quot;holdout&quot; or &quot;cv&quot; for holdout or cross-validation.</p><p>For holdout, you can also set:</p><ul><li><code>split_ratio</code>: the fraction for validation data, 0.1 by default.</li><li><code>X_val</code>, <code>y_val</code>: a separate validation dataset. When they are passed, the validation metrics will be computed against this given validation dataset. If they are not passed, then a validation dataset will be split from the training data and held out from training during the model search. After the model search, flaml will retrain the model with best configuration on the full training data.
You can set<code>retrain_full</code> to be <code>False</code> to skip the final retraining or &quot;budget&quot; to ask flaml to do its best to retrain within the time budget. When <code>retrain_full</code> is set to <code>True</code>, the user-provided validation data is not used in the final retraining of the model.</li></ul><p>For cross validation, you can also set <code>n_splits</code> of the number of folds. By default it is 5.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="data-split-method">Data split method<a aria-hidden="true" class="hash-link" href="#data-split-method" title="Direct link to heading">â€‹</a></h4><p>flaml relies on the provided task type to infer the default splitting strategy:</p><ul><li>stratified split for classification;</li><li>uniform split for regression;</li><li>time-based split for time series forecasting;</li><li>group-based split for learning to rank.</li></ul><p>The data split method for classification can be changed into uniform split by setting <code>split_type=&quot;uniform&quot;</code>. The data are shuffled when <code>split_type in (&quot;uniform&quot;, &quot;stratified&quot;)</code>.</p><p>For both classification and regression tasks more advanced split configurations are possible:</p><ul><li>time-based split can be enforced if the data are sorted by timestamps, by setting <code>split_type=&quot;time&quot;</code>,</li><li>group-based splits can be set by using <code>split_type=&quot;group&quot;</code> while providing the group identifier for each sample through the <code>groups</code> argument. This is also shown in an <a href="https://github.com/microsoft/FLAML/blob/main/notebook/basics/understanding_cross_validation.ipynb" target="_blank" rel="noopener noreferrer">example notebook</a>.</li></ul><p>More in general, <code>split_type</code> can also be set as a custom splitter object, when <code>eval_method=&quot;cv&quot;</code>. It needs to be an instance of a derived class of scikit-learn
<a href="https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.KFold.html#sklearn.model_selection.KFold" target="_blank" rel="noopener noreferrer">KFold</a>
and have <code>split</code> and <code>get_n_splits</code> methods with the same signatures.  To disable shuffling, the splitter instance must contain the attribute <code>shuffle=False</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="parallel-tuning">Parallel tuning<a aria-hidden="true" class="hash-link" href="#parallel-tuning" title="Direct link to heading">â€‹</a></h3><p>When you have parallel resources, you can either spend them in training and keep the model search sequential, or perform parallel search. Following scikit-learn, the parameter <code>n_jobs</code> specifies how many CPU cores to use for each training job. The number of parallel trials is specified via the parameter <code>n_concurrent_trials</code>. By default, <code>n_jobs=-1, n_concurrent_trials=1</code>. That is, all the CPU cores (in a single compute node) are used for training a single model and the search is sequential. When you have more resources than what each single training job needs, you can consider increasing <code>n_concurrent_trials</code>.</p><p>FLAML now support two backends for parallel tuning, i.e., <code>Ray</code> and <code>Spark</code>. You can use either of them, but not both for one tuning job.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parallel-tuning-with-ray">Parallel tuning with Ray<a aria-hidden="true" class="hash-link" href="#parallel-tuning-with-ray" title="Direct link to heading">â€‹</a></h4><p>To do parallel tuning with Ray, install the <code>ray</code> and <code>blendsearch</code> options:</p><div class="codeBlockContainer_J+bg language-bash"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">ray,blendsearch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>ray</code> is used to manage the resources. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">ray</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">init</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">num_cpus</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">16</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>allocates 16 CPU cores. Then, when you run:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_jobs</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_concurrent_trials</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>flaml will perform 4 trials in parallel, each consuming 4 CPU cores. The parallel tuning uses the <a href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function##blendsearch-economical-hyperparameter-optimization-with-blended-search-strategy">BlendSearch</a> algorithm.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="parallel-tuning-with-spark">Parallel tuning with Spark<a aria-hidden="true" class="hash-link" href="#parallel-tuning-with-spark" title="Direct link to heading">â€‹</a></h4><p>To do parallel tuning with Spark, install the <code>spark</code> and <code>blendsearch</code> options:</p><blockquote><p><em>Spark support is added in v1.1.0</em></p></blockquote><div class="codeBlockContainer_J+bg language-bash"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">spark,blendsearch</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;=</span><span class="token number" style="color:rgb(247, 140, 108)">1.1</span><span class="token plain">.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For more details about installing Spark, please refer to <a href="/FLAML/docs/Installation#distributed-tuning">Installation</a>.</p><p>An example of using Spark for parallel tuning is:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_concurrent_trials</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> use_spark</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Details about parallel tuning with Spark could be found <a href="/FLAML/docs/Examples/Integrate - Spark#parallel-spark-jobs">here</a>. For Spark clusters, by default, we will launch one trial per executor. However, sometimes we want to launch more trials than the number of executors (e.g., local mode). In this case, we can set the environment variable <code>FLAML_MAX_CONCURRENT</code> to override the detected <code>num_executors</code>. The final number of concurrent trials will be the minimum of <code>n_concurrent_trials</code> and <code>num_executors</code>. Also, GPU training is not supported yet when use_spark is True.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="guidelines-on-parallel-vs-sequential-tuning"><strong>Guidelines on parallel vs sequential tuning</strong><a aria-hidden="true" class="hash-link" href="#guidelines-on-parallel-vs-sequential-tuning" title="Direct link to heading">â€‹</a></h4><p><strong>(1) Considerations on wall-clock time.</strong></p><p>One common motivation for parallel tuning is to save wall-clock time. When sequential tuning and parallel tuning achieve a similar wall-clock time, sequential tuning should be preferred. This is a rule of thumb when the HPO algorithm is sequential by nature (e.g., Bayesian Optimization and FLAML&#x27;s HPO algorithms CFO and BS). Sequential tuning allows the HPO algorithms to take advantage of the historical trial results. Then the question is <strong>How to estimate the wall-clock-time needed by parallel tuning and sequential tuning</strong>?</p><p>You can use the following way to roughly estimate the wall-clock time in parallel tuning and sequential tuning: To finish <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> trials of hyperparameter tuning, i.e., run <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span></span></span></span></span> hyperparameter configurations, the total wall-clock time needed is <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi mathvariant="normal">/</mi><mi>k</mi><mstyle mathcolor="#cc0000"><mtext>\*</mtext></mstyle><mo stretchy="false">(</mo><mi>S</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi><mi>T</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>l</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi><mo>+</mo><mi>O</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">N/k\*(SingleTrialTime + Overhead)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.10903em">N</span><span class="mord">/</span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mord text" style="color:#cc0000"><span class="mord" style="color:#cc0000">\*</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span><span class="mspace" style="margin-right:0.2222222222222222em"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span><span class="mclose">)</span></span></span></span></span>, in which <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi><mi>T</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>l</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">SingleTrialTime</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span></span></span></span></span> is the trial time to evaluate a particular hyperparameter configuration, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span></span></span></span></span> is the scale of parallelism, e.g., the number of parallel CPU/GPU cores, and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Overhead</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span></span> is the computation overhead.</p><p>In sequential tuning, <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span></span></span></span></span>, and in parallel tuning <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k&gt;1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.73354em;vertical-align:-0.0391em"></span><span class="mord mathnormal" style="margin-right:0.03148em">k</span><span class="mspace" style="margin-right:0.2777777777777778em"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2777777777777778em"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em"></span><span class="mord">1</span></span></span></span></span>. This may suggest that parallel tuning has a shorter wall-clock time. But it is not always the case considering the other two factors <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi><mi>T</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>l</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">SingleTrialTime</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span></span></span></span></span>, and <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Overhead</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span></span>:</p><ul><li><p>The <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mi>v</mi><mi>e</mi><mi>r</mi><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi></mrow><annotation encoding="application/x-tex">Overhead</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em"></span><span class="mord mathnormal" style="margin-right:0.02778em">O</span><span class="mord mathnormal" style="margin-right:0.03588em">v</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">h</span><span class="mord mathnormal">e</span><span class="mord mathnormal">a</span><span class="mord mathnormal">d</span></span></span></span></span> in sequential tuning is typically negligible; while in parallel tuning, it is relatively large.</p></li><li><p>You can also try to reduce the <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi><mi>T</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>l</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">SingleTrialTime</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span></span></span></span></span> to reduce the wall-clock time in sequential tuning: For example, by increasing the resource consumed by a single trial (distributed or multi-thread training), you can reduce <span class="math math-inline"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>l</mi><mi>e</mi><mi>T</mi><mi>r</mi><mi>i</mi><mi>a</mi><mi>l</mi><mi>T</mi><mi>i</mi><mi>m</mi><mi>e</mi></mrow><annotation encoding="application/x-tex">SingleTrialTime</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em"></span><span class="mord mathnormal" style="margin-right:0.05764em">S</span><span class="mord mathnormal">i</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.03588em">g</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal" style="margin-right:0.02778em">r</span><span class="mord mathnormal">i</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.01968em">l</span><span class="mord mathnormal" style="margin-right:0.13889em">T</span><span class="mord mathnormal">i</span><span class="mord mathnormal">m</span><span class="mord mathnormal">e</span></span></span></span></span>. One concrete example is to use the <code>n_jobs</code> parameter that sets the number of threads the fitting process can use in many scikit-learn style algorithms.</p></li></ul><p><strong>(2) Considerations on randomness.</strong></p><p>Potential reasons that cause randomness:</p><ol><li><p>Parallel tuning: In the case of parallel tuning, the order of trials&#x27; finishing time is no longer deterministic. This non-deterministic order, combined with sequential HPO algorithms, leads to a non-deterministic hyperparameter tuning trajectory.</p></li><li><p>Distributed or multi-thread training: Distributed/multi-thread training may introduce randomness in model training, i.e., the trained model with the same hyperparameter may be different because of such randomness. This model-level randomness may be undesirable in some cases.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_y2LR" id="warm-start">Warm start<a aria-hidden="true" class="hash-link" href="#warm-start" title="Direct link to heading">â€‹</a></h3><p>We can warm start the AutoML by providing starting points of hyperparameter configurstions for each estimator. For example, if you have run AutoML for one hour, after checking the results, you would like to run it for another two hours, then you can use the best configurations found for each estimator as the starting points for the new run.</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl1 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> time_budget</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">3600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl2 </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    time_budget</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">7200</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    starting_points</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">automl1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_config_per_estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>starting_points</code> is a dictionary or a str to specify the starting hyperparameter config. (1) When it is a dictionary, the keys are the estimator names. If you do not need to specify starting points for an estimator, exclude its name from the dictionary. The value for each key can be either a dictionary of a list of dictionaries, corresponding to one hyperparameter configuration, or multiple hyperparameter configurations, respectively. (2) When it is a str: if &quot;data&quot;, use data-dependent defaults; if &quot;data:path&quot;, use data-dependent defaults which are stored at path; if &quot;static&quot;, use data-independent defaults. Please find more details about data-dependent defaults in <a href="/FLAML/docs/Use-Cases/Zero-Shot-AutoML#combine-zero-shot-automl-and-hyperparameter-tuning">zero shot AutoML</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="log-the-trials">Log the trials<a aria-hidden="true" class="hash-link" href="#log-the-trials" title="Direct link to heading">â€‹</a></h3><p>The trials are logged in a file if a <code>log_file_name</code> is passed.
Each trial is logged as a json record in one line. The best trial&#x27;s id is logged in the last line. For example,</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{&quot;record_id&quot;: 0, &quot;iter_per_learner&quot;: 1, &quot;logged_metric&quot;: null, &quot;trial_time&quot;: 0.12717914581298828, &quot;wall_clock_time&quot;: 0.1728971004486084, &quot;validation_loss&quot;: 0.07333333333333332, &quot;config&quot;: {&quot;n_estimators&quot;: 4, &quot;num_leaves&quot;: 4, &quot;min_child_samples&quot;: 20, &quot;learning_rate&quot;: 0.09999999999999995, &quot;log_max_bin&quot;: 8, &quot;colsample_bytree&quot;: 1.0, &quot;reg_alpha&quot;: 0.0009765625, &quot;reg_lambda&quot;: 1.0}, &quot;learner&quot;: &quot;lgbm&quot;, &quot;sample_size&quot;: 150}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{&quot;record_id&quot;: 1, &quot;iter_per_learner&quot;: 3, &quot;logged_metric&quot;: null, &quot;trial_time&quot;: 0.07027268409729004, &quot;wall_clock_time&quot;: 0.3756711483001709, &quot;validation_loss&quot;: 0.05333333333333332, &quot;config&quot;: {&quot;n_estimators&quot;: 4, &quot;num_leaves&quot;: 4, &quot;min_child_samples&quot;: 12, &quot;learning_rate&quot;: 0.2677050123105203, &quot;log_max_bin&quot;: 7, &quot;colsample_bytree&quot;: 1.0, &quot;reg_alpha&quot;: 0.001348364934537134, &quot;reg_lambda&quot;: 1.4442580148221913}, &quot;learner&quot;: &quot;lgbm&quot;, &quot;sample_size&quot;: 150}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">{&quot;curr_best_record_id&quot;: 1}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ol><li><code>iter_per_learner</code> means how many models have been tried for each learner. The reason you see records like <code>iter_per_learner=3</code> for <code>record_id=1</code> is that flaml only logs better configs than the previous iters by default, i.e., <code>log_type=&#x27;better&#x27;</code>. If you use <code>log_type=&#x27;all&#x27;</code> instead, all the trials will be logged.</li><li><code>trial_time</code> means the time taken to train and evaluate one config in that trial. <code>total_search_time</code> is the total time spent from the beginning of <code>fit()</code>.</li><li>flaml will adjust the <code>n_estimators</code> for lightgbm etc. according to the remaining budget and check the time budget constraint and stop in several places. Most of the time that makes <code>fit()</code> stops before the given budget. Occasionally it may run over the time budget slightly. But the log file always contains the best config info and you can recover the best model until any time point using <code>retrain_from_log()</code>.</li></ol><p>We can also use mlflow for logging:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_experiment</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;flaml&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To disable mlflow logging pre-configured in FLAML, set <code>mlflow_logging=False</code>:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">mlflow_logging</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>or</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> mlflow_logging</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">False</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Setting <code>mlflow_logging=False</code> in the constructor will disable mlflow logging for all the <code>fit()</code> calls.
Setting <code>mlflow_logging=False</code> in <code>fit()</code> will disable mlflow logging for that <code>fit()</code> call only.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="extra-fit-arguments">Extra fit arguments<a aria-hidden="true" class="hash-link" href="#extra-fit-arguments" title="Direct link to heading">â€‹</a></h3><p>Extra fit arguments that are needed by the estimators can be passed to <code>AutoML.fit()</code>. For example, if there is a weight associated with each training example, they can be passed via <code>sample_weight</code>. For another example, <code>period</code> can be passed for time series forecaster. For any extra keywork argument passed to <code>AutoML.fit()</code> which has not been explicitly listed in the function signature, it will be passed to the underlying estimators&#x27; <code>fit()</code> as is. For another example, you can set the number of gpus used by each trial with the <code>gpu_per_trial</code> argument, which is only used by TransformersEstimator and XGBoostSklearnEstimator.</p><p>In addition, you can specify the different arguments needed by different estimators using the <code>fit_kwargs_by_estimator</code> argument. For example, you can set the custom arguments for a Transformers model:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> load_openml_dataset</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> load_openml_dataset</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dataset_id</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1169</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> data_dir</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;./&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_budget&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;estimator_list&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;catboost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;fit_kwargs_by_estimator&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;catboost&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;verbose&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># setting the verbosity of catboost to True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">automl_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="retrieve-the-outcomes">Retrieve the Outcomes<a aria-hidden="true" class="hash-link" href="#retrieve-the-outcomes" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="get-best-model">Get best model<a aria-hidden="true" class="hash-link" href="#get-best-model" title="Direct link to heading">â€‹</a></h3><p>The best model can be obtained by the <code>model</code> property of an <code>AutoML</code> instance. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> task</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;regression&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># &lt;flaml.automl.model.LGBMEstimator object at 0x7f9b502c4550&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><a href="/FLAML/docs/reference/automl/model#lgbmestimator-objects"><code>flaml.automl.model.LGBMEstimator</code></a> is a wrapper class for LightGBM models. To access the underlying model, use the <code>estimator</code> property of the <code>flaml.automl.model.LGBMEstimator</code> instance.</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">LGBMRegressor(colsample_bytree=0.7610534336273627,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">              learning_rate=0.41929025492645006, max_bin=255,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">              min_child_samples=4, n_estimators=45, num_leaves=4,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">              reg_alpha=0.0009765625, reg_lambda=0.009280655005879943,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">              verbose=-1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token triple-quoted-string string" style="color:rgb(195, 232, 141)">&quot;&quot;&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Just like a normal LightGBM model, we can inspect it. For example, we can plot the feature importance:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pyplot </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">barh</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">feature_name_</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">feature_importances_</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="png" src="data:image/png;base64,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"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="get-best-configuration">Get best configuration<a aria-hidden="true" class="hash-link" href="#get-best-configuration" title="Direct link to heading">â€‹</a></h3><p>We can find the best estimator&#x27;s name and best configuration by:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># lgbm</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># {&#x27;n_estimators&#x27;: 148, &#x27;num_leaves&#x27;: 18, &#x27;min_child_samples&#x27;: 3, &#x27;learning_rate&#x27;: 0.17402065726724145, &#x27;log_max_bin&#x27;: 8, &#x27;colsample_bytree&#x27;: 0.6649148062238498, &#x27;reg_alpha&#x27;: 0.0009765625, &#x27;reg_lambda&#x27;: 0.0067613624509965}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>We can also find the best configuration per estimator.</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_config_per_estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># {&#x27;lgbm&#x27;: {&#x27;n_estimators&#x27;: 148, &#x27;num_leaves&#x27;: 18, &#x27;min_child_samples&#x27;: 3, &#x27;learning_rate&#x27;: 0.17402065726724145, &#x27;log_max_bin&#x27;: 8, &#x27;colsample_bytree&#x27;: 0.6649148062238498, &#x27;reg_alpha&#x27;: 0.0009765625, &#x27;reg_lambda&#x27;: 0.0067613624509965}, &#x27;rf&#x27;: None, &#x27;catboost&#x27;: None, &#x27;xgboost&#x27;: {&#x27;n_estimators&#x27;: 4, &#x27;max_leaves&#x27;: 4, &#x27;min_child_weight&#x27;: 1.8630223791106992, &#x27;learning_rate&#x27;: 1.0, &#x27;subsample&#x27;: 0.8513627344387318, &#x27;colsample_bylevel&#x27;: 1.0, &#x27;colsample_bytree&#x27;: 0.946138073111236, &#x27;reg_alpha&#x27;: 0.0018311776973217073, &#x27;reg_lambda&#x27;: 0.27901659190538414}, &#x27;extra_tree&#x27;: {&#x27;n_estimators&#x27;: 4, &#x27;max_features&#x27;: 1.0, &#x27;max_leaves&#x27;: 4}}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>None</code> value corresponds to the estimators which have not been tried.</p><p>Other useful information:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_config_train_time</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 0.24841618537902832</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_iteration</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">best_loss</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 0.15448622217577546</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">time_to_find_best_model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 0.4167296886444092</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">config_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># {0: (&#x27;lgbm&#x27;, {&#x27;n_estimators&#x27;: 4, &#x27;num_leaves&#x27;: 4, &#x27;min_child_samples&#x27;: 20, &#x27;learning_rate&#x27;: 0.09999999999999995, &#x27;log_max_bin&#x27;: 8, &#x27;colsample_bytree&#x27;: 1.0, &#x27;reg_alpha&#x27;: 0.0009765625, &#x27;reg_lambda&#x27;: 1.0}, 1.2300517559051514)}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Meaning: at iteration 0, the config tried is {&#x27;n_estimators&#x27;: 4, &#x27;num_leaves&#x27;: 4, &#x27;min_child_samples&#x27;: 20, &#x27;learning_rate&#x27;: 0.09999999999999995, &#x27;log_max_bin&#x27;: 8, &#x27;colsample_bytree&#x27;: 1.0, &#x27;reg_alpha&#x27;: 0.0009765625, &#x27;reg_lambda&#x27;: 1.0} for lgbm, and the wallclock time is 1.23s when this trial is finished.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="plot-learning-curve">Plot learning curve<a aria-hidden="true" class="hash-link" href="#plot-learning-curve" title="Direct link to heading">â€‹</a></h3><p>To plot how the loss is improved over time during the model search, first load the search history from the log file:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> get_output_from_log</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">time_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> best_valid_loss_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> valid_loss_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> config_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> metric_history </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    get_output_from_log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">filename</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_file_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> time_budget</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">120</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Then, assuming the optimization metric is &quot;accuracy&quot;, we can plot the accuracy versus wallclock time:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pyplot </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">title</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Learning Curve&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">xlabel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Wall Clock Time (s)&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ylabel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Validation Accuracy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">step</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">time_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">array</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">best_valid_loss_history</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> where</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;post&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">show</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="png" src="data:image/png;base64,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"></p><p>The curve suggests that increasing the time budget may further improve the accuracy.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-set-time-budget">How to set time budget<a aria-hidden="true" class="hash-link" href="#how-to-set-time-budget" title="Direct link to heading">â€‹</a></h3><ul><li>If you have an exact constraint for the total search time, set it as the time budget.</li><li>If you have flexible time constraints, for example, your desirable time budget is t1=60s, and the longest time budget you can tolerate is t2=3600s, you can try the following two ways:</li></ul><ol><li>set t1 as the time budget, and check the message in the console log in the end. If the budget is too small, you will see a warning like</li></ol><blockquote><p>WARNING - Time taken to find the best model is 91% of the provided time budget and not all estimators&#x27; hyperparameter search converged. Consider increasing the time budget.</p></blockquote><ol start="2"><li>set t2 as the time budget, and also set <code>early_stop=True</code>. If the early stopping is triggered, you will see a warning like</li></ol><blockquote><p>WARNING - All estimator hyperparameters local search has converged at least once, and the total search time exceeds 10 times the time taken to find the best model.</p></blockquote><blockquote><p>WARNING - Stopping search as early_stop is set to True.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="how-much-time-is-needed-to-find-the-best-model">How much time is needed to find the best model<a aria-hidden="true" class="hash-link" href="#how-much-time-is-needed-to-find-the-best-model" title="Direct link to heading">â€‹</a></h3><p>If you want to get a sense of how much time is needed to find the best model, you can use <code>max_iter=2</code> to perform two trials first. The message will be like:</p><blockquote><p>INFO - iteration 0, current learner lgbm</p></blockquote><blockquote><p>INFO - Estimated sufficient time budget=145194s. Estimated necessary time budget=2118s.</p></blockquote><blockquote><p>INFO -  at 2.6s,  estimator lgbm&#x27;s best error=0.4459,     best estimator lgbm&#x27;s best error=0.4459</p></blockquote><p>You will see that the time to finish the first and cheapest trial is 2.6 seconds. The estimated necessary time budget is 2118 seconds, and the estimated sufficient time budget is 145194 seconds. Note that this is only an estimated range to help you decide your budget.</p><p>When the time budget is set too low, it can happen that no estimator is trained at all within the budget. In this case, it is recommanded to use <code>max_iter</code> instead of <code>time_budget</code>. This ensures that you have enough time to train a model without worring about variance of the execution time for the code before starting a trainning.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/FLAML/edit/main/website/docs/Use-Cases/Task-Oriented-AutoML.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/FLAML/docs/Use-Cases/Autogen"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->AutoGen for Large Language Models</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Tune User Defined Function<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#customize-automlfit" class="table-of-contents__link toc-highlight">Customize AutoML.fit()</a><ul><li><a href="#optimization-metric" class="table-of-contents__link toc-highlight">Optimization metric</a></li><li><a href="#estimator-and-search-space" class="table-of-contents__link toc-highlight">Estimator and search space</a></li><li><a href="#constraint" class="table-of-contents__link toc-highlight">Constraint</a></li><li><a href="#ensemble" class="table-of-contents__link toc-highlight">Ensemble</a></li><li><a href="#resampling-strategy" class="table-of-contents__link toc-highlight">Resampling strategy</a></li><li><a href="#parallel-tuning" class="table-of-contents__link toc-highlight">Parallel tuning</a></li><li><a href="#warm-start" class="table-of-contents__link toc-highlight">Warm start</a></li><li><a href="#log-the-trials" class="table-of-contents__link toc-highlight">Log the trials</a></li><li><a href="#extra-fit-arguments" class="table-of-contents__link toc-highlight">Extra fit arguments</a></li></ul></li><li><a href="#retrieve-the-outcomes" class="table-of-contents__link toc-highlight">Retrieve the Outcomes</a><ul><li><a href="#get-best-model" class="table-of-contents__link toc-highlight">Get best model</a></li><li><a href="#get-best-configuration" class="table-of-contents__link toc-highlight">Get best configuration</a></li><li><a href="#plot-learning-curve" class="table-of-contents__link toc-highlight">Plot learning curve</a></li><li><a href="#how-to-set-time-budget" class="table-of-contents__link toc-highlight">How to set time budget</a></li><li><a href="#how-much-time-is-needed-to-find-the-best-model" class="table-of-contents__link toc-highlight">How much time is needed to find the best model</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/Cppx2vSPVP" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 FLAML Authors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/FLAML/assets/js/runtime~main.597cf7c4.js"></script>
<script src="/FLAML/assets/js/main.ced98023.js"></script>
</body>
</html>