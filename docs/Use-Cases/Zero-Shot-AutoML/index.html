<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v0.0.0-4193">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">Zero Shot AutoML | FLAML</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://microsoft.github.io//FLAML/docs/Use-Cases/Zero-Shot-AutoML"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Zero Shot AutoML | FLAML"><meta data-react-helmet="true" name="description" content="flaml.default is a package for zero-shot AutoML, or &quot;no-tuning&quot; AutoML. It uses flaml.AutoML and flaml.default.portfolio to mine good hyperparameter configurations across different datasets offline, and recommend data-dependent default configurations at runtime without expensive tuning."><meta data-react-helmet="true" property="og:description" content="flaml.default is a package for zero-shot AutoML, or &quot;no-tuning&quot; AutoML. It uses flaml.AutoML and flaml.default.portfolio to mine good hyperparameter configurations across different datasets offline, and recommend data-dependent default configurations at runtime without expensive tuning."><link data-react-helmet="true" rel="shortcut icon" href="/FLAML/img/flaml_logo.ico"><link data-react-helmet="true" rel="canonical" href="https://microsoft.github.io//FLAML/docs/Use-Cases/Zero-Shot-AutoML"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io//FLAML/docs/Use-Cases/Zero-Shot-AutoML" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io//FLAML/docs/Use-Cases/Zero-Shot-AutoML" hreflang="x-default"><link rel="stylesheet" href="/FLAML/assets/css/styles.b5f81c4f.css">
<link rel="preload" href="/FLAML/assets/js/runtime~main.09199573.js" as="script">
<link rel="preload" href="/FLAML/assets/js/main.c8811c84.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/FLAML/"><div class="navbar__logo"><img src="/FLAML/img/flaml_logo_fill.svg" alt="FLAML" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/FLAML/img/flaml_logo_fill.svg" alt="FLAML" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">FLAML</b></a><a class="navbar__item navbar__link navbar__link--active" href="/FLAML/docs/Getting-Started">Docs</a><a class="navbar__item navbar__link" href="/FLAML/docs/reference/automl">SDK</a><a class="navbar__item navbar__link" href="/FLAML/docs/FAQ">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/FLAML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Getting-Started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Use Cases</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Use-Cases/Task-Oriented-AutoML">Task Oriented AutoML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function">Tune User Defined Function</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/FLAML/docs/Use-Cases/Zero-Shot-AutoML">Zero Shot AutoML</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Contribute">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Research">Research in FLAML</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Zero Shot AutoML</h1></header><p><code>flaml.default</code> is a package for zero-shot AutoML, or &quot;no-tuning&quot; AutoML. It uses <a href="/FLAML/docs/reference/automl#automl-objects"><code>flaml.AutoML</code></a> and <a href="/FLAML/docs/reference/default/portfolio"><code>flaml.default.portfolio</code></a> to mine good hyperparameter configurations across different datasets offline, and recommend data-dependent default configurations at runtime without expensive tuning.</p><p>Zero-shot AutoML has several benefits:</p><ul><li>The computation cost is just training one model. No tuning is involved.</li><li>The decision of hyperparameter configuration is instant. No overhead to worry about.</li><li>Your code remains the same. No breaking of the existing workflow.</li><li>It requires less input from the user. No need to specify a tuning budget etc.</li><li>All training data are used for, guess what, training. No need to worry about holding a subset of training data for validation (and overfitting the validation data).</li><li>The offline preparation can be customized for a domain and leverage the historical tuning data. No experience is wasted.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-use-at-runtime">How to Use at Runtime<a aria-hidden="true" class="hash-link" href="#how-to-use-at-runtime" title="Direct link to heading">â€‹</a></h2><p>The easiest way to leverage this technique is to import a &quot;flamlized&quot; learner of your favorite choice and use it just as how you use the learner before. The automation is done behind the scene and you are not required to change your code. For example, if you are currently using:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> lightgbm </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> LGBMRegressor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">estimator </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LGBMRegressor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Simply replace the first line with:</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">default </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> LGBMRegressor</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>All the other code remains the same. And you are expected to get a equal or better model in most cases.</p><p>The current list of &quot;flamlized&quot; learners are:</p><ul><li>LGBMClassifier, LGBMRegressor.</li><li>XGBClassifier, XGBRegressor.</li><li>RandomForestClassifier, RandomForestRegressor.</li><li>ExtraTreesClassifier, ExtraTreesRegressor.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="whats-the-magic-behind-the-scene">What&#x27;s the magic behind the scene?<a aria-hidden="true" class="hash-link" href="#whats-the-magic-behind-the-scene" title="Direct link to heading">â€‹</a></h3><p><code>flaml.default.LGBMRegressor</code> inherits <code>lightgbm.LGBMRegressor</code>, so all the APIs in <code>lightgbm.LGBMRegressor</code> are still valid in <code>flaml.default.LGBMRegressor</code>. The difference is, <code>flaml.default.LGBMRegressor</code> decides the hyperparameter configurations based on the training data. It would use a different configuration if it is predicted to outperform the original data-independent default. If you inspect the params of the fitted estimator, you can find what configuration is used. If the original default configuration is used, then it is equivalent to the original estimator.</p><p>The recommendation of which configuration should be used is based on offline AutoML run results. Information about the training dataset, such as the size of the dataset will be used to recommend a data-dependent configuration. The recommendation is done instantly in negligible time. The training can be faster or slower than using the original default configuration depending on the recommended configuration. Note that there is no tuning involved. Only one model is trained.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="can-i-check-the-configuration-before-training">Can I check the configuration before training?<a aria-hidden="true" class="hash-link" href="#can-i-check-the-configuration-before-training" title="Direct link to heading">â€‹</a></h3><p>Yes. You can use <code>suggest_hyperparams()</code> to find the suggested configuration. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">default </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> LGBMRegressor</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">estimator </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> LGBMRegressor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> estimator_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> X_transformed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_transformed </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">suggest_hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you would like more control over the training, use an equivalent, open-box way for zero-shot AutoML. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">default </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> preprocess_and_suggest_hyperparams</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> load_iris</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">return_X_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> as_frame</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> train_test_split</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> test_size</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">0.33</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> random_state</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">42</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> estimator_class</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> X_transformed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_transformed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> feature_transformer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label_transformer </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> preprocess_and_suggest_hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lgbm&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">model </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> estimator_class</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># estimator_class is lightgbm.LGBMClassifier</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_transformed</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># LGBMClassifier can handle raw labels</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> feature_transformer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># preprocess test data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Note that some classifiers like XGBClassifier require the labels to be integers, while others do not. So you can decide whether to use the transformed labels <code>y_transformed</code> and the label transformer <code>label_transformer</code>.
Also, each estimator may require specific preprocessing of the data. <code>X_transformed</code> is the preprocessed data, and <code>feature_transformer</code> is the preprocessor. It needs to be applied to the test data before prediction. These are automated when you use the &quot;flamlized&quot; learner. When you use the open-box way, pay attention to them.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="combine-zero-shot-automl-and-hyperparameter-tuning">Combine zero shot AutoML and hyperparameter tuning<a aria-hidden="true" class="hash-link" href="#combine-zero-shot-automl-and-hyperparameter-tuning" title="Direct link to heading">â€‹</a></h3><p>Zero Shot AutoML is fast. If tuning from the recommended data-dependent configuration is required, you can use <code>flaml.AutoML.fit()</code> and set <code>starting_points=&quot;data&quot;</code>. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;starting_points&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;data&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;estimator_list&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lgbm&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_budget&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">600</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_iter&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">50</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">automl_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Note that if you set <code>max_iter=0</code> and <code>time_budget=None</code>, you are effectively using zero-shot AutoML. When <code>estimator_list</code> is omitted, the estimator together with its hyperparameter configuration will be decided in a zero-shot manner.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="use-your-own-meta-learned-defaults">Use your own meta-learned defaults<a aria-hidden="true" class="hash-link" href="#use-your-own-meta-learned-defaults" title="Direct link to heading">â€‹</a></h3><p>To use your own meta-learned defaults, specify the path containing the meta-learned defaults. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">estimator </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">default</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">LGBMRegressor</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">default_location</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;location_for_defaults&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Or,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">preprocess_and_suggest_hyperparams</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lgbm&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> location</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;location_for_defaults&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Or,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> load_iris</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">return_X_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> as_frame</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">as_frame</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl_settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_file_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;test/iris.log&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;starting_points&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;data:location_for_defaults&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;estimator_list&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lgbm&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;xgb_limitdepth&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;rf&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_iter&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">automl_settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Since this is a multiclass task, it will look for the following files under <code>{location_for_defaults}/</code>:</p><ul><li><code>all/multiclass.json</code>.</li><li><code>{learner_name}/multiclass.json</code> for every learner_name in the estimator_list.</li></ul><p>Read the next section to understand how to generate these files if you would like to meta-learn the defaults yourself.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="how-to-prepare-offline">How to Prepare Offline<a aria-hidden="true" class="hash-link" href="#how-to-prepare-offline" title="Direct link to heading">â€‹</a></h2><p>This section is intended for:</p><ol><li>AutoML providers for a particular domain.</li><li>Data scientists or engineers who need to repeatedly train models for similar tasks with varying training data.</li></ol><p>Instead of running full hyperparameter tuning from scratch every time, one can leverage the tuning experiences in similar tasks before. While we have offered the meta-learned defaults from tuning experiences of several popular learners on benchmark datasets for classification and regression, you can customize the defaults for your own tasks/learners/metrics based on your own tuning experiences.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="prepare-a-collection-of-training-tasks">Prepare a collection of training tasks<a aria-hidden="true" class="hash-link" href="#prepare-a-collection-of-training-tasks" title="Direct link to heading">â€‹</a></h3><p>Collect a diverse set of training tasks. For each task, extract its meta feature and save in a .csv file. For example, test/default/all/metafeatures.csv:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dataset,NumberOfInstances,NumberOfFeatures,NumberOfClasses,PercentageOfNumericFeatures</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,36691,10,0,1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,43957,14,2,0.42857142857142855</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Airlines,485444,7,2,0.42857142857142855</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Albert,382716,78,2,0.3333333333333333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Amazon_employee_access,29492,9,2,0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bng_breastTumor,104976,9,0,0.1111111111111111</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">bng_pbc,900000,18,0,0.5555555555555556</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">car,1555,6,4,0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">connect-4,60801,42,3,0.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">dilbert,9000,2000,5,1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Dionis,374569,60,355,1.0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">poker,922509,10,0,1.0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The first column is the dataset name, and the latter four are meta features.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="prepare-the-candidate-configurations">Prepare the candidate configurations<a aria-hidden="true" class="hash-link" href="#prepare-the-candidate-configurations" title="Direct link to heading">â€‹</a></h3><p>You can extract the best configurations for each task in your collection of training tasks by running flaml on each of them with a long enough budget. Save the best configuration in a .json file under <code>{location_for_defaults}/{learner_name}/{task_name}.json</code>. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> load_iris</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">return_X_y</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> as_frame</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">as_frame</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> estimator_list</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;lgbm&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">save_best_config</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;test/default/lgbm/iris.json&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="evaluate-each-candidate-configuration-on-each-task">Evaluate each candidate configuration on each task<a aria-hidden="true" class="hash-link" href="#evaluate-each-candidate-configuration-on-each-task" title="Direct link to heading">â€‹</a></h3><p>Save the evaluation results in a .csv file. For example, save the evaluation results for lgbm under <code>test/default/lgbm/results.csv</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">task,fold,type,result,params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.946366,{&#x27;_modeljson&#x27;: &#x27;lgbm/2dplanes.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.907774,{&#x27;_modeljson&#x27;: &#x27;lgbm/adult.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.901643,{&#x27;_modeljson&#x27;: &#x27;lgbm/Airlines.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.915098,{&#x27;_modeljson&#x27;: &#x27;lgbm/Albert.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.302328,{&#x27;_modeljson&#x27;: &#x27;lgbm/Amazon_employee_access.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.94523,{&#x27;_modeljson&#x27;: &#x27;lgbm/bng_breastTumor.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.945698,{&#x27;_modeljson&#x27;: &#x27;lgbm/bng_pbc.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.946194,{&#x27;_modeljson&#x27;: &#x27;lgbm/car.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.945549,{&#x27;_modeljson&#x27;: &#x27;lgbm/connect-4.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.946232,{&#x27;_modeljson&#x27;: &#x27;lgbm/default.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.945594,{&#x27;_modeljson&#x27;: &#x27;lgbm/dilbert.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.836996,{&#x27;_modeljson&#x27;: &#x27;lgbm/Dionis.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2dplanes,0,regression,0.917152,{&#x27;_modeljson&#x27;: &#x27;lgbm/poker.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.927203,{&#x27;_modeljson&#x27;: &#x27;lgbm/2dplanes.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.932072,{&#x27;_modeljson&#x27;: &#x27;lgbm/adult.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.926563,{&#x27;_modeljson&#x27;: &#x27;lgbm/Airlines.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.928604,{&#x27;_modeljson&#x27;: &#x27;lgbm/Albert.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.911171,{&#x27;_modeljson&#x27;: &#x27;lgbm/Amazon_employee_access.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.930645,{&#x27;_modeljson&#x27;: &#x27;lgbm/bng_breastTumor.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.928603,{&#x27;_modeljson&#x27;: &#x27;lgbm/bng_pbc.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.915825,{&#x27;_modeljson&#x27;: &#x27;lgbm/car.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.919499,{&#x27;_modeljson&#x27;: &#x27;lgbm/connect-4.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.930109,{&#x27;_modeljson&#x27;: &#x27;lgbm/default.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.932453,{&#x27;_modeljson&#x27;: &#x27;lgbm/dilbert.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.921959,{&#x27;_modeljson&#x27;: &#x27;lgbm/Dionis.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">adult,0,binary,0.910763,{&#x27;_modeljson&#x27;: &#x27;lgbm/poker.json&#x27;}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>type</code> column indicates the type of the task, such as regression, binary or multiclass.
The <code>result</code> column stores the evaluation result, assumed the large the better. The <code>params</code> column indicates which json config is used. For example &#x27;lgbm/2dplanes.json&#x27; indicates that the best lgbm configuration extracted from 2dplanes is used.
Different types of tasks can appear in the same file, as long as any json config file can be used in all the tasks. For example, &#x27;lgbm/2dplanes.json&#x27; is extracted from a regression task, and it can be applied to binary and multiclass tasks as well.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="learn-data-dependent-defaults">Learn data-dependent defaults<a aria-hidden="true" class="hash-link" href="#learn-data-dependent-defaults" title="Direct link to heading">â€‹</a></h3><p>To recap, the inputs required for meta-learning are:</p><ol><li>Metafeatures: e.g., <code>{location}/all/metafeatures.csv</code>.</li><li>Configurations: <code>{location}/{learner_name}/{task_name}.json</code>.</li><li>Evaluation results: <code>{location}/{learner_name}/results.csv</code>.</li></ol><p>For example, if the input location is &quot;test/default&quot;, learners are lgbm, xgb_limitdepth and rf, the following command learns data-dependent defaults for binary classification tasks.</p><div class="codeBlockContainer_J+bg language-bash"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">python portfolio.py --output test/default --input test/default --metafeatures test/default/all/metafeatures.csv --task binary --estimator lgbm xgb_limitdepth rf</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In a few seconds, it will produce the following files as output:</p><ul><li>test/default/lgbm/binary.json: the learned defaults for lgbm.</li><li>test/default/xgb_limitdepth/binary.json: the learned defaults for xgb_limitdepth.</li><li>test/default/rf/binary.json: the learned defaults for rf.</li><li>test/default/all/binary.json: the learned defaults for lgbm, xgb_limitdepth and rf together.</li></ul><p>Change &quot;binary&quot; into &quot;multiclass&quot; or &quot;regression&quot;, or your own types in your &quot;results.csv&quot; for the other types of tasks. To update the learned defaults when more experiences are available, simply update your input files and rerun the learning command.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="flamlize-a-learner">&quot;Flamlize&quot; a learner<a aria-hidden="true" class="hash-link" href="#flamlize-a-learner" title="Direct link to heading">â€‹</a></h3><p>You have now effectively built your own zero-shot AutoML solution. Congratulations!</p><p>Optionally, you can &quot;flamlize&quot; a learner using <a href="/FLAML/docs/reference/default/estimator#flamlize_estimator"><code>flaml.default.flamlize_estimator</code></a> for easy dissemination. For example,</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ensemble </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> ensemble</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">default </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> flamlize_estimator</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ExtraTreesClassifier </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> flamlize_estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    ensemble</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ExtraTreesClassifier</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;extra_tree&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;classification&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Then, you can share this &quot;flamlized&quot; <code>ExtraTreesClassifier</code> together with the location of your learned defaults with others (or the <em>future</em> yourself). They will benefit from your past experience. Your group can also share experiences in a central place and update the learned defaults continuously. Over time, your organization gets better collectively.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/FLAML/edit/main/website/docs/Use-Cases/Zero-Shot-AutoML.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/FLAML/docs/Use-Cases/Tune-User-Defined-Function"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Tune User Defined Function</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/FLAML/docs/Examples/AutoML-Classification"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AutoML - Classification<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-use-at-runtime" class="table-of-contents__link toc-highlight">How to Use at Runtime</a><ul><li><a href="#whats-the-magic-behind-the-scene" class="table-of-contents__link toc-highlight">What&#39;s the magic behind the scene?</a></li><li><a href="#can-i-check-the-configuration-before-training" class="table-of-contents__link toc-highlight">Can I check the configuration before training?</a></li><li><a href="#combine-zero-shot-automl-and-hyperparameter-tuning" class="table-of-contents__link toc-highlight">Combine zero shot AutoML and hyperparameter tuning</a></li><li><a href="#use-your-own-meta-learned-defaults" class="table-of-contents__link toc-highlight">Use your own meta-learned defaults</a></li></ul></li><li><a href="#how-to-prepare-offline" class="table-of-contents__link toc-highlight">How to Prepare Offline</a><ul><li><a href="#prepare-a-collection-of-training-tasks" class="table-of-contents__link toc-highlight">Prepare a collection of training tasks</a></li><li><a href="#prepare-the-candidate-configurations" class="table-of-contents__link toc-highlight">Prepare the candidate configurations</a></li><li><a href="#evaluate-each-candidate-configuration-on-each-task" class="table-of-contents__link toc-highlight">Evaluate each candidate configuration on each task</a></li><li><a href="#learn-data-dependent-defaults" class="table-of-contents__link toc-highlight">Learn data-dependent defaults</a></li><li><a href="#flamlize-a-learner" class="table-of-contents__link toc-highlight">&quot;Flamlize&quot; a learner</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 FLAML Authors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/FLAML/assets/js/runtime~main.09199573.js"></script>
<script src="/FLAML/assets/js/main.c8811c84.js"></script>
</body>
</html>