<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v0.0.0-4193">
<link rel="alternate" type="application/rss+xml" href="/FLAML/blog/rss.xml" title="FLAML RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/FLAML/blog/atom.xml" title="FLAML Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">AutoML - Time Series Forecast | FLAML</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://microsoft.github.io//FLAML/docs/Examples/AutoML-Time series forecast"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="AutoML - Time Series Forecast | FLAML"><meta data-react-helmet="true" name="description" content="Prerequisites"><meta data-react-helmet="true" property="og:description" content="Prerequisites"><link data-react-helmet="true" rel="shortcut icon" href="/FLAML/img/flaml_logo.ico"><link data-react-helmet="true" rel="canonical" href="https://microsoft.github.io//FLAML/docs/Examples/AutoML-Time series forecast"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io//FLAML/docs/Examples/AutoML-Time series forecast" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://microsoft.github.io//FLAML/docs/Examples/AutoML-Time series forecast" hreflang="x-default"><link rel="stylesheet" href="/FLAML/assets/css/styles.a35b243d.css">
<link rel="preload" href="/FLAML/assets/js/runtime~main.597cf7c4.js" as="script">
<link rel="preload" href="/FLAML/assets/js/main.ced98023.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/FLAML/"><div class="navbar__logo"><img src="/FLAML/img/flaml_logo_fill.svg" alt="FLAML" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/FLAML/img/flaml_logo_fill.svg" alt="FLAML" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">FLAML</b></a><a class="navbar__item navbar__link navbar__link--active" href="/FLAML/docs/Getting-Started">Docs</a><a class="navbar__item navbar__link" href="/FLAML/docs/reference/automl/automl">SDK</a><a class="navbar__item navbar__link" href="/FLAML/blog">Blog</a><a class="navbar__item navbar__link" href="/FLAML/docs/FAQ">FAQ</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/microsoft/FLAML" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_I7kZ"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_Zg7X searchBarLoadingRing_J5Ez"><div></div><div></div><div></div><div></div></div><div class="searchHintContainer_CDc6"><kbd class="searchHint_2RRg">ctrl</kbd><kbd class="searchHint_2RRg">K</kbd></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Getting-Started">Getting Started</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Use Cases</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Examples</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoGen-AgentChat">AutoGen - Automated Multi Agent Chat</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoGen-OpenAI">AutoGen - Tune GPT Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoML-Classification">AutoML - Classification</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoML-NLP">AutoML - NLP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoML-Rank">AutoML - Rank</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoML-Regression">AutoML - Regression</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/FLAML/docs/Examples/AutoML-Time series forecast">AutoML - Time Series Forecast</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoML-for-LightGBM">AutoML for LightGBM</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/AutoML-for-XGBoost">AutoML for XGBoost</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Default-Flamlized">Default - Flamlized Estimator</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Integrate - AzureML">Integrate - AzureML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Integrate - Scikit-learn Pipeline">Integrate - Scikit-learn Pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Integrate - Spark">Integrate - Spark</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Tune-AzureML-pipeline">Tune - AzureML pipeline</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Tune-HuggingFace">Tune - HuggingFace</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Tune-Lexicographic-objectives">Tune - Lexicographic Objectives</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/FLAML/docs/Examples/Tune-PyTorch">Tune - PyTorch</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Contribute">Contributing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FLAML/docs/Research">Research</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>AutoML - Time Series Forecast</h1></header><h3 class="anchor anchorWithStickyNavbar_y2LR" id="prerequisites">Prerequisites<a aria-hidden="true" class="hash-link" href="#prerequisites" title="Direct link to heading">â€‹</a></h3><p>Install the <!-- -->[<!-- -->automl,ts_forecast<!-- -->]<!-- --> option.</p><div class="codeBlockContainer_J+bg language-bash"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">pip </span><span class="token function" style="color:rgb(130, 170, 255)">install</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;flaml[automl,ts_forecast]&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="simple-numpy-example">Simple NumPy Example<a aria-hidden="true" class="hash-link" href="#simple-numpy-example" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">arange</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2014-01&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;2022-01&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> dtype</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;datetime64[M]&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_train </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">random</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">size</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">84</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token number" style="color:rgb(247, 140, 108)">84</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># a single column of timestamp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># value for each timestamp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    period</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># time horizon to forecast, e.g., 12 months</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    task</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ts_forecast&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    time_budget</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># time budget in seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    log_file_name</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ts_forecast.log&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    eval_method</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;holdout&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">84</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><strong>Note</strong>: You can access the best model&#x27;s estimator using <code>automl.model.estimator</code>.</p><h4 class="anchor anchorWithStickyNavbar_y2LR" id="sample-output">Sample output<a aria-hidden="true" class="hash-link" href="#sample-output" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:20] {2018} INFO - task = ts_forecast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:20] {2020} INFO - Data split method: time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:20] {2024} INFO - Evaluation method: holdout</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:20] {2124} INFO - Minimizing error metric: mape</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2181} INFO - List of ML learners in AutoML Run: [&#x27;lgbm&#x27;, &#x27;rf&#x27;, &#x27;xgboost&#x27;, &#x27;extra_tree&#x27;, &#x27;xgb_limitdepth&#x27;, &#x27;prophet&#x27;, &#x27;arima&#x27;, &#x27;sarimax&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 0, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2547} INFO - Estimated sufficient time budget=1429s. Estimated necessary time budget=1s.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.9811,     best estimator lgbm&#x27;s best error=0.9811</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 1, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.9811,     best estimator lgbm&#x27;s best error=0.9811</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 2, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.9811,     best estimator lgbm&#x27;s best error=0.9811</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 3, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.9811,     best estimator lgbm&#x27;s best error=0.9811</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 4, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.9811,     best estimator lgbm&#x27;s best error=0.9811</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 5, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.9811,     best estimator lgbm&#x27;s best error=0.9811</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 6, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.9652,     best estimator lgbm&#x27;s best error=0.9652</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 7, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 8, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:21] {2434} INFO - iteration 9, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 10, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 11, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 12, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 13, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 14, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 15, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.2s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 16, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.2s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 17, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.2s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 18, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.2s,  estimator rf&#x27;s best error=1.0994,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 19, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.2s,  estimator rf&#x27;s best error=1.0848,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 20, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.3s,  estimator xgboost&#x27;s best error=1.0271,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 21, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.3s,  estimator rf&#x27;s best error=1.0848,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 22, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.3s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 23, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.3s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 24, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.3s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 25, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.3s,  estimator extra_tree&#x27;s best error=1.0130,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 26, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.4s,  estimator extra_tree&#x27;s best error=1.0130,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 27, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.4s,  estimator extra_tree&#x27;s best error=1.0130,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 28, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.4s,  estimator extra_tree&#x27;s best error=1.0130,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 29, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.4s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 30, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.5s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 31, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.5s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 32, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.5s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 33, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.5s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 34, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.5s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 35, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.5s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 36, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.6s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 37, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.6s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 38, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.6s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 39, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.6s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 40, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.6s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 41, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.7s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 42, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.7s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 43, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.7s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 44, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.7s,  estimator xgb_limitdepth&#x27;s best error=1.5815,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 45, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.8s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 46, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.8s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 47, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.8s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 48, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.9s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 49, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.9s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 50, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.9s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 51, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 1.9s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 52, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 2.0s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 53, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 2.0s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 54, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 2.0s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 55, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 2.0s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 56, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 2.0s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 57, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2594} INFO -  at 2.0s,  estimator rf&#x27;s best error=1.0848,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:22] {2434} INFO - iteration 58, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2594} INFO -  at 2.1s,  estimator xgboost&#x27;s best error=1.0015,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2434} INFO - iteration 59, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2594} INFO -  at 2.1s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2434} INFO - iteration 60, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2594} INFO -  at 2.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2434} INFO - iteration 61, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2594} INFO -  at 2.1s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2434} INFO - iteration 62, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2594} INFO -  at 2.1s,  estimator lgbm&#x27;s best error=0.9466,     best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2434} INFO - iteration 63, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2594} INFO -  at 2.2s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:23] {2434} INFO - iteration 64, current learner prophet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.2s,  estimator prophet&#x27;s best error=1.5706,  best estimator lgbm&#x27;s best error=0.9466</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 65, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.2s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 66, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.4s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 67, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.4s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 68, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.5s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 69, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.6s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 70, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.6s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 71, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.6s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 72, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.6s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 73, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.7s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 74, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.7s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 75, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.8s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 76, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 4.9s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 77, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2594} INFO -  at 5.0s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:25] {2434} INFO - iteration 78, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2594} INFO -  at 5.1s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2434} INFO - iteration 79, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2594} INFO -  at 5.1s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2434} INFO - iteration 80, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2594} INFO -  at 5.1s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2434} INFO - iteration 81, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2594} INFO -  at 5.1s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:26] {2434} INFO - iteration 82, current learner prophet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.6s,  estimator prophet&#x27;s best error=1.4076,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 83, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.6s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 84, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.6s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 85, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.6s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 86, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.8s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 87, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.8s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 88, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.9s,  estimator sarimax&#x27;s best error=0.5693,  best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 89, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 6.9s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 90, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 7.0s,  estimator arima&#x27;s best error=0.5693,    best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 91, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 7.0s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 92, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2594} INFO -  at 7.0s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator arima&#x27;s best error=0.5693</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:27] {2434} INFO - iteration 93, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.0s,  estimator sarimax&#x27;s best error=0.5600,  best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 94, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.1s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 95, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.2s,  estimator sarimax&#x27;s best error=0.5600,  best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 96, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.2s,  estimator arima&#x27;s best error=0.5693,    best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 97, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.2s,  estimator arima&#x27;s best error=0.5693,    best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 98, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.3s,  estimator extra_tree&#x27;s best error=0.9499,       best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 99, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.3s,  estimator sarimax&#x27;s best error=0.5600,  best estimator sarimax&#x27;s best error=0.5600</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2434} INFO - iteration 100, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 08:01:28] {2594} INFO -  at 7.3s,  estimator xgb_limitdepth&#x27;s best error=0.9683,   best estimator sarimax&#x27;s best error=0.5600</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="univariate-time-series">Univariate time series<a aria-hidden="true" class="hash-link" href="#univariate-time-series" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> statsmodels</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">api </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> sm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> sm</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">datasets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">co2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">load_pandas</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># data is given in weeks, but the task is to predict monthly, so use monthly averages instead</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;co2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">resample</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MS&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">bfill</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ffill</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># makes sure there are no missing values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_frame</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">num_samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">time_horizon </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">split_idx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> num_samples </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> time_horizon</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">train_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">split_idx</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># train_df is a dataframe with two columns: timestamp and label</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">split_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;index&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_frame</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># X_test is a dataframe with dates for prediction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">split_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;co2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># y_test is a series of the values corresponding to the dates for prediction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_budget&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># total running time in seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metric&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mape&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># primary metric for validation: &#x27;mape&#x27; is generally used for forecast tasks</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ts_forecast&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># task type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_file_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CO2_forecast.log&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># flaml log file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eval_method&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;holdout&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># validation method can be chosen from [&#x27;auto&#x27;, &#x27;holdout&#x27;, &#x27;cv&#x27;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;seed&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">7654321</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># random seed</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    dataframe</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">train_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># training data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;co2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># label column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    period</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">time_horizon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># key word argument &#x27;period&#x27; must be included for forecast task)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="sample-output-1">Sample output<a aria-hidden="true" class="hash-link" href="#sample-output-1" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:04] {2018} INFO - task = ts_forecast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:04] {2020} INFO - Data split method: time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:04] {2024} INFO - Evaluation method: holdout</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:04] {2124} INFO - Minimizing error metric: mape</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Importing plotly failed. Interactive plots will not work.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:04] {2181} INFO - List of ML learners in AutoML Run: [&#x27;lgbm&#x27;, &#x27;rf&#x27;, &#x27;xgboost&#x27;, &#x27;extra_tree&#x27;, &#x27;xgb_limitdepth&#x27;, &#x27;prophet&#x27;, &#x27;arima&#x27;, &#x27;sarimax&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:04] {2434} INFO - iteration 0, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2547} INFO - Estimated sufficient time budget=2145s. Estimated necessary time budget=2s.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.0621,     best estimator lgbm&#x27;s best error=0.0621</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 1, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0574,     best estimator lgbm&#x27;s best error=0.0574</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 2, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0464,     best estimator lgbm&#x27;s best error=0.0464</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 3, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0464,     best estimator lgbm&#x27;s best error=0.0464</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 4, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0365,     best estimator lgbm&#x27;s best error=0.0365</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 5, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.0192,     best estimator lgbm&#x27;s best error=0.0192</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 6, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.0192,     best estimator lgbm&#x27;s best error=0.0192</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 7, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.0192,     best estimator lgbm&#x27;s best error=0.0192</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 8, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.2s,  estimator lgbm&#x27;s best error=0.0110,     best estimator lgbm&#x27;s best error=0.0110</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 9, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.2s,  estimator lgbm&#x27;s best error=0.0110,     best estimator lgbm&#x27;s best error=0.0110</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 10, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.2s,  estimator lgbm&#x27;s best error=0.0036,     best estimator lgbm&#x27;s best error=0.0036</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 11, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.4s,  estimator lgbm&#x27;s best error=0.0023,     best estimator lgbm&#x27;s best error=0.0023</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 12, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.4s,  estimator lgbm&#x27;s best error=0.0023,     best estimator lgbm&#x27;s best error=0.0023</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 13, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.5s,  estimator lgbm&#x27;s best error=0.0021,     best estimator lgbm&#x27;s best error=0.0021</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 14, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.6s,  estimator lgbm&#x27;s best error=0.0021,     best estimator lgbm&#x27;s best error=0.0021</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 15, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.7s,  estimator lgbm&#x27;s best error=0.0020,     best estimator lgbm&#x27;s best error=0.0020</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 16, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2594} INFO -  at 1.8s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:05] {2434} INFO - iteration 17, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 1.9s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 18, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.0s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 19, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.1s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 20, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.1s,  estimator rf&#x27;s best error=0.0228,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 21, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.1s,  estimator rf&#x27;s best error=0.0210,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 22, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.2s,  estimator xgboost&#x27;s best error=0.6738,  best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 23, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.2s,  estimator xgboost&#x27;s best error=0.6738,  best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 24, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.2s,  estimator xgboost&#x27;s best error=0.1717,  best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 25, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.3s,  estimator xgboost&#x27;s best error=0.0249,  best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 26, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.3s,  estimator xgboost&#x27;s best error=0.0249,  best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 27, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.3s,  estimator xgboost&#x27;s best error=0.0242,  best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 28, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.4s,  estimator extra_tree&#x27;s best error=0.0245,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 29, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.4s,  estimator extra_tree&#x27;s best error=0.0160,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 30, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.5s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 31, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.6s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 32, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.6s,  estimator rf&#x27;s best error=0.0210,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 33, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.6s,  estimator extra_tree&#x27;s best error=0.0160,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 34, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.8s,  estimator lgbm&#x27;s best error=0.0017,     best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 35, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2594} INFO -  at 2.8s,  estimator extra_tree&#x27;s best error=0.0158,       best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:06] {2434} INFO - iteration 36, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 2.8s,  estimator xgb_limitdepth&#x27;s best error=0.0447,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 37, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 2.9s,  estimator xgb_limitdepth&#x27;s best error=0.0447,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 38, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 2.9s,  estimator xgb_limitdepth&#x27;s best error=0.0029,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 39, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 3.0s,  estimator xgb_limitdepth&#x27;s best error=0.0018,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 40, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 3.1s,  estimator xgb_limitdepth&#x27;s best error=0.0018,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 41, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 3.1s,  estimator xgb_limitdepth&#x27;s best error=0.0018,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 42, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2594} INFO -  at 3.3s,  estimator xgb_limitdepth&#x27;s best error=0.0018,   best estimator lgbm&#x27;s best error=0.0017</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:07] {2434} INFO - iteration 43, current learner prophet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:09] {2594} INFO -  at 5.5s,  estimator prophet&#x27;s best error=0.0008,  best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:09] {2434} INFO - iteration 44, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2594} INFO -  at 6.1s,  estimator arima&#x27;s best error=0.0047,    best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2434} INFO - iteration 45, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2594} INFO -  at 6.4s,  estimator sarimax&#x27;s best error=0.0047,  best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2434} INFO - iteration 46, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2594} INFO -  at 6.5s,  estimator lgbm&#x27;s best error=0.0017,     best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2434} INFO - iteration 47, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2594} INFO -  at 6.6s,  estimator sarimax&#x27;s best error=0.0047,  best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:10] {2434} INFO - iteration 48, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2594} INFO -  at 6.9s,  estimator sarimax&#x27;s best error=0.0047,  best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2434} INFO - iteration 49, current learner arima</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2594} INFO -  at 6.9s,  estimator arima&#x27;s best error=0.0047,    best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2434} INFO - iteration 50, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2594} INFO -  at 7.0s,  estimator xgb_limitdepth&#x27;s best error=0.0018,   best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2434} INFO - iteration 51, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2594} INFO -  at 7.5s,  estimator sarimax&#x27;s best error=0.0047,  best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2434} INFO - iteration 52, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2594} INFO -  at 7.6s,  estimator xgboost&#x27;s best error=0.0242,  best estimator prophet&#x27;s best error=0.0008</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:11] {2434} INFO - iteration 53, current learner prophet</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2594} INFO -  at 9.3s,  estimator prophet&#x27;s best error=0.0005,  best estimator prophet&#x27;s best error=0.0005</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2434} INFO - iteration 54, current learner sarimax</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2594} INFO -  at 9.4s,  estimator sarimax&#x27;s best error=0.0047,  best estimator prophet&#x27;s best error=0.0005</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2434} INFO - iteration 55, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2594} INFO -  at 9.8s,  estimator xgb_limitdepth&#x27;s best error=0.0018,   best estimator prophet&#x27;s best error=0.0005</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2434} INFO - iteration 56, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2594} INFO -  at 9.8s,  estimator xgboost&#x27;s best error=0.0242,  best estimator prophet&#x27;s best error=0.0005</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:13] {2434} INFO - iteration 57, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2594} INFO -  at 9.9s,  estimator lgbm&#x27;s best error=0.0017,     best estimator prophet&#x27;s best error=0.0005</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2434} INFO - iteration 58, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2594} INFO -  at 10.0s, estimator rf&#x27;s best error=0.0146,       best estimator prophet&#x27;s best error=0.0005</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2824} INFO - retrain prophet for 0.6s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2831} INFO - retrained model: &lt;prophet.forecaster.Prophet object at 0x7fb68ea65d60&gt;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2210} INFO - fit succeeded</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2211} INFO - Time taken to find the best model: 9.339771270751953</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 01-21 07:54:14] {2222} WARNING - Time taken to find the best model is 93% of the provided time budget and not all estimators&#x27; hyperparameter search converged. Consider increasing the time budget.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="compute-and-plot-predictions">Compute and plot predictions<a aria-hidden="true" class="hash-link" href="#compute-and-plot-predictions" title="Direct link to heading">â€‹</a></h4><p>The example plotting code requires matplotlib.</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">flaml_y_pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pyplot </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Actual level&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">plot</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> flaml_y_pred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> label</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;FLAML forecast&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">xlabel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">ylabel</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CO2 Levels&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">legend</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><img alt="png" src="/FLAML/assets/images/CO2-8a52a5b6467f2f3c0b4bc0fc516d5a62.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="multivariate-time-series-forecasting-with-exogenous-variables">Multivariate Time Series (Forecasting with Exogenous Variables)<a aria-hidden="true" class="hash-link" href="#multivariate-time-series-forecasting-with-exogenous-variables" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> pandas </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># pd.set_option(&quot;display.max_rows&quot;, None, &quot;display.max_columns&quot;, None)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">read_csv</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;https://raw.githubusercontent.com/srivatsan88/YouTubeLI/master/dataset/nyc_energy_consumption.csv&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># preprocessing data</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeStamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_datetime</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeStamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">set_index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeStamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">resample</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;D&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">method</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ffill&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;precip&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;precip&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fillna</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">method</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ffill&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># last two rows are NaN for &#x27;demand&#x27; column so remove them</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Using temperature values create categorical values</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># where 1 denotes daily tempurature is above monthly average and 0 is below.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_monthly_avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;month&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeStamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">month</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;month&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;month&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">agg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mean&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">monthly_avg </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_monthly_avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">to_dict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">above_monthly_avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> temp</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    month </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">month</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">if</span><span class="token plain"> temp </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> monthly_avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">month</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">else</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp_above_monthly_avg&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">apply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> above_monthly_avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeStamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> axis</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">del</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;month&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># remove temperature column to reduce redundancy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># split data into train and test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">num_samples </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">shape</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_time_horizon </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">180</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">split_idx </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> num_samples </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> multi_time_horizon</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_train_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain">split_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_test_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">split_idx</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_X_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_test_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;timeStamp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;precip&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;temp_above_monthly_avg&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># test dataframe must contain values for the regressors / multivariate variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">multi_y_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> multi_test_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;demand&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># initialize AutoML instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># configure AutoML settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_budget&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">10</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># total running time in seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metric&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mape&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># primary metric</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ts_forecast&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># task type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_file_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;energy_forecast_categorical.log&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># flaml log file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eval_method&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;holdout&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_type&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;all&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;label&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;demand&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># train the model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">dataframe</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> period</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">time_horizon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># predictions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">multi_X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="sample-output-2">Sample Output<a aria-hidden="true" class="hash-link" href="#sample-output-2" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:11] {2540} INFO - task = ts_forecast</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:11] {2542} INFO - Data split method: time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:11] {2545} INFO - Evaluation method: holdout</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:11] {2664} INFO - Minimizing error metric: mape</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {2806} INFO - List of ML learners in AutoML Run: [&#x27;lgbm&#x27;, &#x27;rf&#x27;, &#x27;xgboost&#x27;, &#x27;extra_tree&#x27;, &#x27;xgb_limitdepth&#x27;, &#x27;prophet&#x27;, &#x27;arima&#x27;, &#x27;sarimax&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 0, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3241} INFO - Estimated sufficient time budget=7681s. Estimated necessary time budget=8s.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 0.8s,  estimator lgbm&#x27;s best error=0.0854, best estimator lgbm&#x27;s best error=0.0854</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 1, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.0854, best estimator lgbm&#x27;s best error=0.0854</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 2, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.0525, best estimator lgbm&#x27;s best error=0.0525</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 3, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 0.9s,  estimator lgbm&#x27;s best error=0.0525, best estimator lgbm&#x27;s best error=0.0525</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 4, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0406, best estimator lgbm&#x27;s best error=0.0406</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 5, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0406, best estimator lgbm&#x27;s best error=0.0406</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 6, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3288} INFO -  at 1.0s,  estimator lgbm&#x27;s best error=0.0406, best estimator lgbm&#x27;s best error=0.0406</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:12] {3108} INFO - iteration 7, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:13] {3288} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.0393, best estimator lgbm&#x27;s best error=0.0393</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:13] {3108} INFO - iteration 8, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:13] {3288} INFO -  at 1.1s,  estimator lgbm&#x27;s best error=0.0393, best estimator lgbm&#x27;s best error=0.0393</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:13] {3108} INFO - iteration 9, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">...</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              silent=True, subsample=1.0, subsample_for_bin=200000,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              subsample_freq=0, verbose=-1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:22] {2837} INFO - fit succeeded</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 08-13 01:03:22] {2838} INFO - Time taken to find the best model: 3.4941744804382324</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="forecasting-discrete-variables">Forecasting Discrete Variables<a aria-hidden="true" class="hash-link" href="#forecasting-discrete-variables" title="Direct link to heading">â€‹</a></h3><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> hcrystalball</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">utils </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> get_sales_data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> flaml </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> AutoML</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">time_horizon </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">30</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_sales_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">n_dates</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">180</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_assortments</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_states</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> n_stores</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Open&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Promo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Promo2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># feature engineering - create a discrete value column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># 1 denotes above mean and 0 denotes below mean</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;above_mean_sales&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">where</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Sales&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">reset_index</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">inplace</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># train-test split</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">discrete_train_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">time_horizon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">discrete_test_df </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain">time_horizon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">discrete_X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> discrete_X_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    discrete_train_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Open&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Promo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Promo2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    discrete_test_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Open&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Promo&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Promo2&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">discrete_y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> discrete_y_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    discrete_train_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;above_mean_sales&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    discrete_test_df</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;above_mean_sales&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># initialize AutoML instance</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># configure the settings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_budget&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">15</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># total running time in seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metric&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;accuracy&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># primary metric</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ts_forecast_classification&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># task type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_file_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sales_classification_forecast.log&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># flaml log file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eval_method&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;holdout&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># train the model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">discrete_X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> y_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">discrete_y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> period</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">time_horizon</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># make predictions</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">discrete_y_pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">discrete_X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Predicted label&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> discrete_y_pred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;True label&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> discrete_y_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="sample-output-3">Sample Output<a aria-hidden="true" class="hash-link" href="#sample-output-3" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2060} INFO - task = ts_forecast_classification</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2062} INFO - Data split method: time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2066} INFO - Evaluation method: holdout</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2147} INFO - Minimizing error metric: 1-accuracy</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2205} INFO - List of ML learners in AutoML Run: [&#x27;lgbm&#x27;, &#x27;rf&#x27;, &#x27;xgboost&#x27;, &#x27;extra_tree&#x27;, &#x27;xgb_limitdepth&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 0, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2573} INFO - Estimated sufficient time budget=269s. Estimated necessary time budget=0s.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.1s,  estimator lgbm&#x27;s best error=0.2667, best estimator lgbm&#x27;s best error=0.2667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 1, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.1s,  estimator lgbm&#x27;s best error=0.2667, best estimator lgbm&#x27;s best error=0.2667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 2, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.1s,  estimator lgbm&#x27;s best error=0.1333, best estimator lgbm&#x27;s best error=0.1333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 3, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.2s,  estimator rf&#x27;s best error=0.1333,   best estimator lgbm&#x27;s best error=0.1333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 4, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.2s,  estimator xgboost&#x27;s best error=0.1333,  best estimator lgbm&#x27;s best error=0.1333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 5, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.2s,  estimator lgbm&#x27;s best error=0.1333, best estimator lgbm&#x27;s best error=0.1333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 6, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.3s,  estimator rf&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 7, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.3s,  estimator lgbm&#x27;s best error=0.0667, best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 8, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.3s,  estimator lgbm&#x27;s best error=0.0667, best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 9, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.4s,  estimator lgbm&#x27;s best error=0.0667, best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 10, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.4s,  estimator rf&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 11, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.4s,  estimator rf&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 12, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.5s,  estimator xgboost&#x27;s best error=0.1333,  best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 13, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.5s,  estimator extra_tree&#x27;s best error=0.1333,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 14, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.5s,  estimator xgb_limitdepth&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 15, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.6s,  estimator xgboost&#x27;s best error=0.0667,  best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 16, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.6s,  estimator xgb_limitdepth&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 17, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.6s,  estimator rf&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 18, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.7s,  estimator xgb_limitdepth&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 19, current learner lgbm</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.7s,  estimator lgbm&#x27;s best error=0.0667, best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 20, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.7s,  estimator extra_tree&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 21, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.7s,  estimator xgboost&#x27;s best error=0.0667,  best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 22, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2620} INFO -  at 0.8s,  estimator extra_tree&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:03] {2458} INFO - iteration 23, current learner rf</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 0.8s,  estimator rf&#x27;s best error=0.0667,   best estimator rf&#x27;s best error=0.0667</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2458} INFO - iteration 24, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 0.9s,  estimator xgboost&#x27;s best error=0.0333,  best estimator xgboost&#x27;s best error=0.0333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2458} INFO - iteration 25, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 0.9s,  estimator xgb_limitdepth&#x27;s best error=0.0667,   best estimator xgboost&#x27;s best error=0.0333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2458} INFO - iteration 26, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 0.9s,  estimator xgb_limitdepth&#x27;s best error=0.0667,   best estimator xgboost&#x27;s best error=0.0333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2458} INFO - iteration 27, current learner xgboost</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 0.9s,  estimator xgboost&#x27;s best error=0.0333,  best estimator xgboost&#x27;s best error=0.0333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2458} INFO - iteration 28, current learner extra_tree</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 1.0s,  estimator extra_tree&#x27;s best error=0.0667,   best estimator xgboost&#x27;s best error=0.0333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2458} INFO - iteration 29, current learner xgb_limitdepth</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2620} INFO -  at 1.0s,  estimator xgb_limitdepth&#x27;s best error=0.0667,   best estimator xgboost&#x27;s best error=0.0333</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2850} INFO - retrain xgboost for 0.0s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2857} INFO - retrained model: XGBClassifier(base_score=0.5, booster=&#x27;gbtree&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              colsample_bylevel=0.9826753651836615, colsample_bynode=1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              colsample_bytree=0.9725493834064914, gamma=0, gpu_id=-1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              grow_policy=&#x27;lossguide&#x27;, importance_type=&#x27;gain&#x27;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              interaction_constraints=&#x27;&#x27;, learning_rate=0.1665803484560213,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              max_delta_step=0, max_depth=0, max_leaves=4,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              min_child_weight=0.5649012460525115, missing=nan,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              monotone_constraints=&#x27;()&#x27;, n_estimators=4, n_jobs=-1,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              num_parallel_tree=1, objective=&#x27;binary:logistic&#x27;, random_state=0,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              reg_alpha=0.009638363373006869, reg_lambda=0.143703802530408,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              scale_pos_weight=1, subsample=0.9643606787051899,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              tree_method=&#x27;hist&#x27;, use_label_encoder=False,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">              validate_parameters=1, verbosity=0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2234} INFO - fit succeeded</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 02-28 21:53:04] {2235} INFO - Time taken to find the best model: 0.8547139167785645</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="forecasting-with-panel-datasets">Forecasting with Panel Datasets<a aria-hidden="true" class="hash-link" href="#forecasting-with-panel-datasets" title="Direct link to heading">â€‹</a></h3><p>Panel time series datasets involves multiple individual time series. For example, see Stallion demand dataset from PyTorch Forecasting, orginally from Kaggle.</p><div class="codeBlockContainer_J+bg language-python"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token keyword" style="font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">get_stalliion_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">from</span><span class="token plain"> pytorch_forecasting</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">examples </span><span class="token keyword" style="font-style:italic">import</span><span class="token plain"> get_stallion_data</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_stallion_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># add time index - For datasets with no missing values, FLAML will automate this process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">year </span><span class="token operator" style="color:rgb(137, 221, 255)">*</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">12</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">month</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">min</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># add additional features</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;month&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">date</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">dt</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">month</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token builtin" style="color:rgb(130, 170, 255)">str</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;category&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># categories have be strings</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_volume&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">log</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">volume </span><span class="token operator" style="color:rgb(137, 221, 255)">+</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1e-8</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_volume_by_sku&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sku&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> observed</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">volume</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mean&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_volume_by_agency&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">groupby</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;agency&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> observed</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token boolean" style="color:rgb(255, 88, 116)">True</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">volume</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">transform</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mean&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># we want to encode special days as one variable and thus need to first reverse one-hot encoding</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    special_days </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;easter_day&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;good_friday&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;new_year&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;christmas&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;labor_day&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;independence_day&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;revolution_day_memorial&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;regional_games&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;beer_capital&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;music_fest&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">special_days</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">special_days</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">apply</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token keyword" style="font-style:italic">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">map</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;-&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;category&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token keyword" style="font-style:italic">return</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> special_days</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> special_days </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> get_stalliion_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">time_horizon </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">6</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># predict six months</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">training_cutoff </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token builtin" style="color:rgb(130, 170, 255)">max</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token plain"> time_horizon</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">astype</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;int&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">ts_col </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">insert</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token number" style="color:rgb(247, 140, 108)">0</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> ts_col</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># FLAML assumes input is not sorted, but we sort here for comparison purposes with y_test</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">data </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">sort_values</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;agency&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sku&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;date&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_train </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token keyword" style="font-style:italic">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">time_idx </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;=</span><span class="token plain"> training_cutoff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">X_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token keyword" style="font-style:italic">lambda</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> x</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">time_idx </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> training_cutoff</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_train </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;volume&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_test </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">pop</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;volume&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> AutoML</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Configure settings for FLAML model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">settings </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_budget&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> budget</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># total running time in seconds</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;metric&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;mape&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># primary metric</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;task&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ts_forecast_panel&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># task type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_file_name&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;test/stallion_forecast.log&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># flaml log file</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;eval_method&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;holdout&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Specify kwargs for TimeSeriesDataSet used by TemporalFusionTransformerEstimator</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">fit_kwargs_by_estimator </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;tft&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_encoder_length&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">24</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;static_categoricals&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;agency&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sku&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;static_reals&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_population_2017&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_yearly_household_income_2017&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_varying_known_categoricals&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;special_days&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;month&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;variable_groups&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;special_days&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> special_days</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># group of categorical variables can be treated as one variable</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_varying_known_reals&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_idx&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;price_regular&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;discount_in_percent&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_varying_unknown_categoricals&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;time_varying_unknown_reals&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;y&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># always need a &#x27;y&#x27; column for the target column</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;log_volume&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;industry_volume&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;soda_volume&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_max_temp&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_volume_by_agency&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;avg_volume_by_sku&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;batch_size&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">256</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;max_epochs&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;gpu_per_trial&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token operator" style="color:rgb(137, 221, 255)">-</span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Train the model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    X_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    y_train</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">y_train</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token operator" style="color:rgb(137, 221, 255)">**</span><span class="token plain">settings</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    period</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">time_horizon</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    group_ids</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token string" style="color:rgb(195, 232, 141)">&quot;agency&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;sku&quot;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    fit_kwargs_by_estimator</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">fit_kwargs_by_estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># Compute predictions of testing dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">y_pred </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y_test</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">y_pred</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># best model</span><span class="token plain"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token keyword" style="font-style:italic">print</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">automl</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">model</span><span class="token punctuation" style="color:rgb(199, 146, 234)">.</span><span class="token plain">estimator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="sample-output-4">Sample Output<a aria-hidden="true" class="hash-link" href="#sample-output-4" title="Direct link to heading">â€‹</a></h4><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#bfc7d5;background-color:#292d3e"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:26:03] {2478} INFO - task = ts_forecast_panel</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:26:03] {2480} INFO - Data split method: time</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:26:03] {2483} INFO - Evaluation method: holdout</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:26:03] {2552} INFO - Minimizing error metric: mape</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:26:03] {2694} INFO - List of ML learners in AutoML Run: [&#x27;tft&#x27;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:26:03] {2986} INFO - iteration 0, current learner tft</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GPU available: False, used: False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TPU available: False, using: 0 TPU cores</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IPU available: False, using: 0 IPUs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   | Name                               | Type                            | Params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">----------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0  | loss                               | QuantileLoss                    | 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1  | logging_metrics                    | ModuleList                      | 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2  | input_embeddings                   | MultiEmbedding                  | 1.3 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">3  | prescalers                         | ModuleDict                      | 256</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">4  | static_variable_selection          | VariableSelectionNetwork        | 3.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">5  | encoder_variable_selection         | VariableSelectionNetwork        | 8.0 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">6  | decoder_variable_selection         | VariableSelectionNetwork        | 2.7 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">7  | static_context_variable_selection  | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">8  | static_context_initial_hidden_lstm | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">9  | static_context_initial_cell_lstm   | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">10 | static_context_enrichment          | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">11 | lstm_encoder                       | LSTM                            | 4.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">12 | lstm_decoder                       | LSTM                            | 4.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13 | post_lstm_gate_encoder             | GatedLinearUnit                 | 544</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">14 | post_lstm_add_norm_encoder         | AddNorm                         | 32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">15 | static_enrichment                  | GatedResidualNetwork            | 1.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">16 | multihead_attn                     | InterpretableMultiHeadAttention | 676</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">17 | post_attn_gate_norm                | GateAddNorm                     | 576</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">18 | pos_wise_ff                        | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">19 | pre_output_gate_norm               | GateAddNorm                     | 576</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">20 | output_layer                       | Linear                          | 119</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">----------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">33.6 K    Trainable params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0         Non-trainable params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">33.6 K    Total params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0.135     Total estimated model params size (MB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Epoch 19: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 129/129 [00:56&lt;00:00,  2.27it/s, loss=45.9, v_num=2, train_loss_step=43.00, val_loss=65.20, train_loss_epoch=46.50]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:46:46] {3114} INFO - Estimated sufficient time budget=12424212s. Estimated necessary time budget=12424s.</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 21:46:46] {3161} INFO -  at 1242.6s,\testimator tft&#x27;s best error=1324290483134574.7500,\tbest estimator tft&#x27;s best error=1324290483134574.7500</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">GPU available: False, used: False</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">TPU available: False, using: 0 TPU cores</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">IPU available: False, using: 0 IPUs</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   | Name                               | Type                            | Params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">----------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0  | loss                               | QuantileLoss                    | 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">1  | logging_metrics                    | ModuleList                      | 0</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">2  | input_embeddings                   | MultiEmbedding                  | 1.3 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">3  | prescalers                         | ModuleDict                      | 256</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">4  | static_variable_selection          | VariableSelectionNetwork        | 3.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">5  | encoder_variable_selection         | VariableSelectionNetwork        | 8.0 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">6  | decoder_variable_selection         | VariableSelectionNetwork        | 2.7 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">7  | static_context_variable_selection  | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">8  | static_context_initial_hidden_lstm | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">9  | static_context_initial_cell_lstm   | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">10 | static_context_enrichment          | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">11 | lstm_encoder                       | LSTM                            | 4.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">12 | lstm_decoder                       | LSTM                            | 4.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">13 | post_lstm_gate_encoder             | GatedLinearUnit                 | 544</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">14 | post_lstm_add_norm_encoder         | AddNorm                         | 32</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">15 | static_enrichment                  | GatedResidualNetwork            | 1.4 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">16 | multihead_attn                     | InterpretableMultiHeadAttention | 676</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">17 | post_attn_gate_norm                | GateAddNorm                     | 576</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">18 | pos_wise_ff                        | GatedResidualNetwork            | 1.1 K</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">19 | pre_output_gate_norm               | GateAddNorm                     | 576</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">20 | output_layer                       | Linear                          | 119</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">----------------------------------------------------------------------------------------</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">33.6 K    Trainable params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0         Non-trainable params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">33.6 K    Total params</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">0.135     Total estimated model params size (MB)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">Epoch 19: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 145/145 [01:03&lt;00:00,  2.28it/s, loss=45.2, v_num=3, train_loss_step=46.30, val_loss=67.60, train_loss_epoch=48.10]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 22:08:05] {3425} INFO - retrain tft for 1279.6s</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 22:08:05] {3432} INFO - retrained model: TemporalFusionTransformer(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (loss): QuantileLoss()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (logging_metrics): ModuleList(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (0): SMAPE()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (1): MAE()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (2): RMSE()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (3): MAPE()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (input_embeddings): MultiEmbedding(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (embeddings): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (agency): Embedding(58, 16)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (sku): Embedding(25, 10)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (special_days): TimeDistributedEmbeddingBag(11, 6, mode=sum)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (month): Embedding(12, 6)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (prescalers): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (avg_population_2017): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (avg_yearly_household_income_2017): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (encoder_length): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (y_center): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (y_scale): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (time_idx): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (price_regular): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (discount_in_percent): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (relative_time_idx): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (y): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (log_volume): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (industry_volume): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (soda_volume): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (avg_max_temp): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (avg_volume_by_agency): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (avg_volume_by_sku): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (static_variable_selection): VariableSelectionNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (flattened_grn): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((7,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc1): Linear(in_features=66, out_features=7, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc2): Linear(in_features=7, out_features=7, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (fc): Linear(in_features=7, out_features=14, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((7,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (single_variable_grns): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (agency): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (sku): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_population_2017): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_yearly_household_income_2017): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (encoder_length): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (y_center): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (y_scale): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (prescalers): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_population_2017): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_yearly_household_income_2017): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (encoder_length): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (y_center): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (y_scale): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (softmax): Softmax(dim=-1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (encoder_variable_selection): VariableSelectionNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (flattened_grn): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((13,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc1): Linear(in_features=100, out_features=13, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (context): Linear(in_features=16, out_features=13, bias=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc2): Linear(in_features=13, out_features=13, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (fc): Linear(in_features=13, out_features=26, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((13,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (single_variable_grns): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (special_days): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (month): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (time_idx): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (price_regular): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (discount_in_percent): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (relative_time_idx): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (y): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (log_volume): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (industry_volume): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (soda_volume): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_max_temp): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_volume_by_agency): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_volume_by_sku): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (prescalers): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (time_idx): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (price_regular): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (discount_in_percent): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (relative_time_idx): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (y): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (log_volume): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (industry_volume): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (soda_volume): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_max_temp): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_volume_by_agency): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (avg_volume_by_sku): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (softmax): Softmax(dim=-1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (decoder_variable_selection): VariableSelectionNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (flattened_grn): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((6,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc1): Linear(in_features=44, out_features=6, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (context): Linear(in_features=16, out_features=6, bias=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc2): Linear(in_features=6, out_features=6, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (fc): Linear(in_features=6, out_features=12, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((6,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (single_variable_grns): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (special_days): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (month): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (time_idx): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (price_regular): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (discount_in_percent): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (relative_time_idx): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (resample_norm): ResampleNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (resample): TimeDistributedInterpolation()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (gate): Sigmoid()</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc1): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc2): Linear(in_features=8, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (fc): Linear(in_features=8, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (prescalers): ModuleDict(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (time_idx): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (price_regular): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (discount_in_percent): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (relative_time_idx): Linear(in_features=1, out_features=8, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (softmax): Softmax(dim=-1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (static_context_variable_selection): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc1): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc2): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (static_context_initial_hidden_lstm): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc1): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc2): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (static_context_initial_cell_lstm): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc1): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc2): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (static_context_enrichment): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc1): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc2): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (lstm_encoder): LSTM(16, 16, num_layers=2, batch_first=True, dropout=0.1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (lstm_decoder): LSTM(16, 16, num_layers=2, batch_first=True, dropout=0.1)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (post_lstm_gate_encoder): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (post_lstm_gate_decoder): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (post_lstm_add_norm_encoder): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (post_lstm_add_norm_decoder): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (static_enrichment): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc1): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (context): Linear(in_features=16, out_features=16, bias=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc2): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (multihead_attn): InterpretableMultiHeadAttention(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (v_layer): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (q_layers): ModuleList(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (0): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (1): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (2): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (3): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (k_layers): ModuleList(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (0): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (1): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (2): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (3): Linear(in_features=16, out_features=4, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (attention): ScaledDotProductAttention(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (softmax): Softmax(dim=2)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (w_h): Linear(in_features=4, out_features=16, bias=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (post_attn_gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (pos_wise_ff): GatedResidualNetwork(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc1): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (elu): ELU(alpha=1.0)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (fc2): Linear(in_features=16, out_features=16, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (dropout): Dropout(p=0.1, inplace=False)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">        (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (pre_output_gate_norm): GateAddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (glu): GatedLinearUnit(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (fc): Linear(in_features=16, out_features=32, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    (add_norm): AddNorm(</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      (norm): LayerNorm((16,), eps=1e-05, elementwise_affine=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  )</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  (output_layer): Linear(in_features=16, out_features=7, bias=True)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">)</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 22:08:05] {2725} INFO - fit succeeded</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 22:08:05] {2726} INFO - Time taken to find the best model: 1242.6435902118683</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">[flaml.automl: 07-28 22:08:05] {2737} WARNING - Time taken to find the best model is 414% of the provided time budget and not all estimators&#x27; hyperparameter search converged. Consider increasing the time budget.\n&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">     ]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   ],</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><a href="https://github.com/microsoft/FLAML/blob/main/notebook/automl_time_series_forecast.ipynb" target="_blank" rel="noopener noreferrer">Link to notebook</a> | <a href="https://colab.research.google.com/github/microsoft/FLAML/blob/main/notebook/automl_time_series_forecast.ipynb" target="_blank" rel="noopener noreferrer">Open in colab</a></p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/microsoft/FLAML/edit/main/website/docs/Examples/AutoML-Time series forecast.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/FLAML/docs/Examples/AutoML-Regression"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->AutoML - Regression</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/FLAML/docs/Examples/AutoML-for-LightGBM"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">AutoML for LightGBM<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#simple-numpy-example" class="table-of-contents__link toc-highlight">Simple NumPy Example</a></li><li><a href="#univariate-time-series" class="table-of-contents__link toc-highlight">Univariate time series</a></li><li><a href="#multivariate-time-series-forecasting-with-exogenous-variables" class="table-of-contents__link toc-highlight">Multivariate Time Series (Forecasting with Exogenous Variables)</a></li><li><a href="#forecasting-discrete-variables" class="table-of-contents__link toc-highlight">Forecasting Discrete Variables</a></li><li><a href="#forecasting-with-panel-datasets" class="table-of-contents__link toc-highlight">Forecasting with Panel Datasets</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/Cppx2vSPVP" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2025 FLAML Authors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/FLAML/assets/js/runtime~main.597cf7c4.js"></script>
<script src="/FLAML/assets/js/main.ced98023.js"></script>
</body>
</html>