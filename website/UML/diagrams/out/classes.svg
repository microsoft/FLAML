<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="988px" preserveAspectRatio="none" style="width:2074px;height:988px;" version="1.1" viewBox="0 0 2074 988" width="2074px" zoomAndPan="magnify"><defs><filter height="300%" id="f9ksvey7waxum" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--MD5=[e91c1a4b5acdeea7335b57bbce66c349]
cluster torch.nn--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="1453,692.5,1518,692.5,1525,716.1094,1577,716.1094,1577,792.5,1453,792.5,1453,692.5" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1453" x2="1525" y1="716.1094" y2="716.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="59" x="1457" y="709.0332">torch.nn</text><!--MD5=[5be6b5f4908408e11b280e92ddbf8b2c]
cluster transformers--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="1601,692.5,1698,692.5,1705,716.1094,1781,716.1094,1781,965,1601,965,1601,692.5" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1601" x2="1705" y1="716.1094" y2="716.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="91" x="1605" y="709.0332">transformers</text><!--MD5=[3d0354a37b673026761a7074b2752195]
cluster marlin.models.auto.modeling_auto--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="1485,463.5,1732,463.5,1739,487.1094,1742,487.1094,1742,563.5,1485,563.5,1485,463.5" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1485" x2="1739" y1="487.1094" y2="487.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="241" x="1489" y="480.0332">marlin.models.auto.modeling_auto</text><!--MD5=[297e981108e20c3914954bcb39330bfa]
cluster marlin.core.module_interface--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="1205,415,1417,415,1424,438.6094,1429,438.6094,1429,832.5,1205,832.5,1205,415" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1205" x2="1424" y1="438.6094" y2="438.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="206" x="1209" y="431.5332">marlin.core.module_interface</text><!--MD5=[defbb95433352790e66c94624ec985b8]
cluster marlin.core.trainer_backend--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="16,46.5,220,46.5,227,70.1094,543,70.1094,543,620,16,620,16,46.5" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="16" x2="227" y1="70.1094" y2="70.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="198" x="20" y="63.0332">marlin.core.trainer_backend</text><!--MD5=[ea11f6884dbf676fa318a19f7795f9fe]
cluster marlin.core.trainer--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="723,6,859,6,866,29.6094,1201,29.6094,1201,391,723,391,723,6" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="723" x2="866" y1="29.6094" y2="29.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="130" x="727" y="22.5332">marlin.core.trainer</text><!--MD5=[d2041cdcd4e4df0b7203abd93666a07e]
cluster marlin.core.data_interface--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="1805,644,1995,644,2002,667.6094,2005,667.6094,2005,981,1805,981,1805,644" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="1805" x2="2002" y1="667.6094" y2="667.6094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="184" x="1809" y="660.5332">marlin.core.data_interface</text><!--MD5=[08fbfc975adcd8550992b15935d58073]
cluster marlin.core.utils.checkpoint_utils--><polygon fill="#FFFFFF" filter="url(#f9ksvey7waxum)" points="567,439.5,806,439.5,813,463.1094,1120,463.1094,1120,816.5,567,816.5,567,439.5" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="567" x2="813" y1="463.1094" y2="463.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="233" x="571" y="456.0332">marlin.core.utils.checkpoint_utils</text><!--MD5=[8c531128956a2ac9024aa8ee044055fe]
class torch.nn.Module--><rect codeLine="20" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="torch.nn.Module" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="91" x="1469.5" y="728.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="91" x="1469.5" y="728.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="91" x="1469.5" y="755.5"/><rect codeLine="20" fill="none" height="48" id="torch.nn.Module" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="91" x="1469.5" y="728.5"/><ellipse cx="1484.5" cy="744.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1487.2656,740.375 Q1487.4219,740.1563 1487.6094,740.0469 Q1487.7969,739.9375 1488.0156,739.9375 Q1488.3906,739.9375 1488.625,740.1953 Q1488.8594,740.4531 1488.8594,741.0625 L1488.8594,742.5156 Q1488.8594,743.125 1488.625,743.3906 Q1488.3906,743.6563 1488.0156,743.6563 Q1487.6719,743.6563 1487.4688,743.4531 Q1487.2656,743.2656 1487.1563,742.75 Q1487.1094,742.3906 1486.9219,742.2031 Q1486.5938,741.8281 1485.9844,741.6094 Q1485.375,741.3906 1484.75,741.3906 Q1483.9844,741.3906 1483.3516,741.7188 Q1482.7188,742.0469 1482.2266,742.7969 Q1481.7344,743.5469 1481.7344,744.5781 L1481.7344,745.6719 Q1481.7344,746.9063 1482.625,747.7266 Q1483.5156,748.5469 1485.1094,748.5469 Q1486.0469,748.5469 1486.7031,748.2969 Q1487.0938,748.1406 1487.5156,747.7031 Q1487.7813,747.4375 1487.9297,747.3594 Q1488.0781,747.2813 1488.2813,747.2813 Q1488.6094,747.2813 1488.8672,747.5391 Q1489.125,747.7969 1489.125,748.1406 Q1489.125,748.4844 1488.7813,748.8906 Q1488.2813,749.4688 1487.4844,749.7969 Q1486.4063,750.25 1485.1094,750.25 Q1483.5938,750.25 1482.3906,749.625 Q1481.4063,749.125 1480.7188,748.0547 Q1480.0313,746.9844 1480.0313,745.7031 L1480.0313,744.5469 Q1480.0313,743.2188 1480.6484,742.0703 Q1481.2656,740.9219 1482.3594,740.3047 Q1483.4531,739.6875 1484.6875,739.6875 Q1485.4219,739.6875 1486.0703,739.8516 Q1486.7188,740.0156 1487.2656,740.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="59" x="1498.5" y="751.3291">Module</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1470.5" x2="1559.5" y1="760.5" y2="760.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1470.5" x2="1559.5" y1="768.5" y2="768.5"/><!--MD5=[b9c251316f74687d0960e4689c44c4fe]
class transformers.AutoModel--><rect codeLine="21" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="transformers.AutoModel" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="117" x="1624.5" y="728.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="117" x="1624.5" y="728.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="117" x="1624.5" y="755.5"/><rect codeLine="21" fill="none" height="48" id="transformers.AutoModel" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="117" x="1624.5" y="728.5"/><ellipse cx="1639.5" cy="744.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1642.2656,740.375 Q1642.4219,740.1563 1642.6094,740.0469 Q1642.7969,739.9375 1643.0156,739.9375 Q1643.3906,739.9375 1643.625,740.1953 Q1643.8594,740.4531 1643.8594,741.0625 L1643.8594,742.5156 Q1643.8594,743.125 1643.625,743.3906 Q1643.3906,743.6563 1643.0156,743.6563 Q1642.6719,743.6563 1642.4688,743.4531 Q1642.2656,743.2656 1642.1563,742.75 Q1642.1094,742.3906 1641.9219,742.2031 Q1641.5938,741.8281 1640.9844,741.6094 Q1640.375,741.3906 1639.75,741.3906 Q1638.9844,741.3906 1638.3516,741.7188 Q1637.7188,742.0469 1637.2266,742.7969 Q1636.7344,743.5469 1636.7344,744.5781 L1636.7344,745.6719 Q1636.7344,746.9063 1637.625,747.7266 Q1638.5156,748.5469 1640.1094,748.5469 Q1641.0469,748.5469 1641.7031,748.2969 Q1642.0938,748.1406 1642.5156,747.7031 Q1642.7813,747.4375 1642.9297,747.3594 Q1643.0781,747.2813 1643.2813,747.2813 Q1643.6094,747.2813 1643.8672,747.5391 Q1644.125,747.7969 1644.125,748.1406 Q1644.125,748.4844 1643.7813,748.8906 Q1643.2813,749.4688 1642.4844,749.7969 Q1641.4063,750.25 1640.1094,750.25 Q1638.5938,750.25 1637.3906,749.625 Q1636.4063,749.125 1635.7188,748.0547 Q1635.0313,746.9844 1635.0313,745.7031 L1635.0313,744.5469 Q1635.0313,743.2188 1635.6484,742.0703 Q1636.2656,740.9219 1637.3594,740.3047 Q1638.4531,739.6875 1639.6875,739.6875 Q1640.4219,739.6875 1641.0703,739.8516 Q1641.7188,740.0156 1642.2656,740.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="85" x="1653.5" y="751.3291">AutoModel</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1625.5" x2="1740.5" y1="760.5" y2="760.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1625.5" x2="1740.5" y1="768.5" y2="768.5"/><!--MD5=[eeb1236943c331def6cd3426ac2d3db2]
class transformers.AutoTokenizer--><rect codeLine="22" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="transformers.AutoTokenizer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="147" x="1617.5" y="901"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="147" x="1617.5" y="901"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="147" x="1617.5" y="928"/><rect codeLine="22" fill="none" height="48" id="transformers.AutoTokenizer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="147" x="1617.5" y="901"/><ellipse cx="1632.5" cy="917" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1635.2656,912.875 Q1635.4219,912.6563 1635.6094,912.5469 Q1635.7969,912.4375 1636.0156,912.4375 Q1636.3906,912.4375 1636.625,912.6953 Q1636.8594,912.9531 1636.8594,913.5625 L1636.8594,915.0156 Q1636.8594,915.625 1636.625,915.8906 Q1636.3906,916.1563 1636.0156,916.1563 Q1635.6719,916.1563 1635.4688,915.9531 Q1635.2656,915.7656 1635.1563,915.25 Q1635.1094,914.8906 1634.9219,914.7031 Q1634.5938,914.3281 1633.9844,914.1094 Q1633.375,913.8906 1632.75,913.8906 Q1631.9844,913.8906 1631.3516,914.2188 Q1630.7188,914.5469 1630.2266,915.2969 Q1629.7344,916.0469 1629.7344,917.0781 L1629.7344,918.1719 Q1629.7344,919.4063 1630.625,920.2266 Q1631.5156,921.0469 1633.1094,921.0469 Q1634.0469,921.0469 1634.7031,920.7969 Q1635.0938,920.6406 1635.5156,920.2031 Q1635.7813,919.9375 1635.9297,919.8594 Q1636.0781,919.7813 1636.2813,919.7813 Q1636.6094,919.7813 1636.8672,920.0391 Q1637.125,920.2969 1637.125,920.6406 Q1637.125,920.9844 1636.7813,921.3906 Q1636.2813,921.9688 1635.4844,922.2969 Q1634.4063,922.75 1633.1094,922.75 Q1631.5938,922.75 1630.3906,922.125 Q1629.4063,921.625 1628.7188,920.5547 Q1628.0313,919.4844 1628.0313,918.2031 L1628.0313,917.0469 Q1628.0313,915.7188 1628.6484,914.5703 Q1629.2656,913.4219 1630.3594,912.8047 Q1631.4531,912.1875 1632.6875,912.1875 Q1633.4219,912.1875 1634.0703,912.3516 Q1634.7188,912.5156 1635.2656,912.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="115" x="1646.5" y="923.8291">AutoTokenizer</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1618.5" x2="1763.5" y1="933" y2="933"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1618.5" x2="1763.5" y1="941" y2="941"/><!--MD5=[30d79946c5e5bc4665de38e2f112a367]
class marlin.models.auto.modeling_auto.MarlinAutoModel--><rect codeLine="29" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="marlin.models.auto.modeling_auto.MarlinAutoModel" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="166" x="1530" y="499.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="166" x="1530" y="499.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="166" x="1530" y="526.5"/><rect codeLine="29" fill="none" height="48" id="marlin.models.auto.modeling_auto.MarlinAutoModel" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="166" x="1530" y="499.5"/><ellipse cx="1545" cy="515.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1547.7656,511.375 Q1547.9219,511.1563 1548.1094,511.0469 Q1548.2969,510.9375 1548.5156,510.9375 Q1548.8906,510.9375 1549.125,511.1953 Q1549.3594,511.4531 1549.3594,512.0625 L1549.3594,513.5156 Q1549.3594,514.125 1549.125,514.3906 Q1548.8906,514.6563 1548.5156,514.6563 Q1548.1719,514.6563 1547.9688,514.4531 Q1547.7656,514.2656 1547.6563,513.75 Q1547.6094,513.3906 1547.4219,513.2031 Q1547.0938,512.8281 1546.4844,512.6094 Q1545.875,512.3906 1545.25,512.3906 Q1544.4844,512.3906 1543.8516,512.7188 Q1543.2188,513.0469 1542.7266,513.7969 Q1542.2344,514.5469 1542.2344,515.5781 L1542.2344,516.6719 Q1542.2344,517.9063 1543.125,518.7266 Q1544.0156,519.5469 1545.6094,519.5469 Q1546.5469,519.5469 1547.2031,519.2969 Q1547.5938,519.1406 1548.0156,518.7031 Q1548.2813,518.4375 1548.4297,518.3594 Q1548.5781,518.2813 1548.7813,518.2813 Q1549.1094,518.2813 1549.3672,518.5391 Q1549.625,518.7969 1549.625,519.1406 Q1549.625,519.4844 1549.2813,519.8906 Q1548.7813,520.4688 1547.9844,520.7969 Q1546.9063,521.25 1545.6094,521.25 Q1544.0938,521.25 1542.8906,520.625 Q1541.9063,520.125 1541.2188,519.0547 Q1540.5313,517.9844 1540.5313,516.7031 L1540.5313,515.5469 Q1540.5313,514.2188 1541.1484,513.0703 Q1541.7656,511.9219 1542.8594,511.3047 Q1543.9531,510.6875 1545.1875,510.6875 Q1545.9219,510.6875 1546.5703,510.8516 Q1547.2188,511.0156 1547.7656,511.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="134" x="1559" y="522.3291">MarlinAutoModel</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1531" x2="1695" y1="531.5" y2="531.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1531" x2="1695" y1="539.5" y2="539.5"/><!--MD5=[90ddeeaf50ab6eaaa52a6d2fae44af4b]
class marlin.core.module_interface.CallbackInterface--><rect codeLine="34" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="128.4932" id="marlin.core.module_interface.CallbackInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="170" x="1232" y="688.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="170" x="1232" y="688.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="170" x="1232" y="715.5"/><rect codeLine="34" fill="none" height="128.4932" id="marlin.core.module_interface.CallbackInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="170" x="1232" y="688.5"/><ellipse cx="1247" cy="704.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1249.7656,700.375 Q1249.9219,700.1563 1250.1094,700.0469 Q1250.2969,699.9375 1250.5156,699.9375 Q1250.8906,699.9375 1251.125,700.1953 Q1251.3594,700.4531 1251.3594,701.0625 L1251.3594,702.5156 Q1251.3594,703.125 1251.125,703.3906 Q1250.8906,703.6563 1250.5156,703.6563 Q1250.1719,703.6563 1249.9688,703.4531 Q1249.7656,703.2656 1249.6563,702.75 Q1249.6094,702.3906 1249.4219,702.2031 Q1249.0938,701.8281 1248.4844,701.6094 Q1247.875,701.3906 1247.25,701.3906 Q1246.4844,701.3906 1245.8516,701.7188 Q1245.2188,702.0469 1244.7266,702.7969 Q1244.2344,703.5469 1244.2344,704.5781 L1244.2344,705.6719 Q1244.2344,706.9063 1245.125,707.7266 Q1246.0156,708.5469 1247.6094,708.5469 Q1248.5469,708.5469 1249.2031,708.2969 Q1249.5938,708.1406 1250.0156,707.7031 Q1250.2813,707.4375 1250.4297,707.3594 Q1250.5781,707.2813 1250.7813,707.2813 Q1251.1094,707.2813 1251.3672,707.5391 Q1251.625,707.7969 1251.625,708.1406 Q1251.625,708.4844 1251.2813,708.8906 Q1250.7813,709.4688 1249.9844,709.7969 Q1248.9063,710.25 1247.6094,710.25 Q1246.0938,710.25 1244.8906,709.625 Q1243.9063,709.125 1243.2188,708.0547 Q1242.5313,706.9844 1242.5313,705.7031 L1242.5313,704.5469 Q1242.5313,703.2188 1243.1484,702.0703 Q1243.7656,700.9219 1244.8594,700.3047 Q1245.9531,699.6875 1247.1875,699.6875 Q1247.9219,699.6875 1248.5703,699.8516 Q1249.2188,700.0156 1249.7656,700.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="138" x="1261" y="711.3291">CallbackInterface</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1233" x2="1401" y1="720.5" y2="720.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1233" x2="1401" y1="728.5" y2="728.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="129" x="1238" y="745.8608">on_end_train_step()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="141" x="1238" y="761.9595">on_end_train_epoch()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="126" x="1238" y="778.0581">on_end_backward()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="131" x="1238" y="794.1567">on_end_val_epoch()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="94" x="1238" y="810.2554">on_end_train()</text><!--MD5=[26afb8f40e48cce527d96bcce80114cf]
class marlin.core.module_interface.ModuleInterface--><rect codeLine="41" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="144.5918" id="marlin.core.module_interface.ModuleInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="191" x="1221.5" y="451"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="191" x="1221.5" y="451"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="191" x="1221.5" y="478"/><rect codeLine="41" fill="none" height="144.5918" id="marlin.core.module_interface.ModuleInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="191" x="1221.5" y="451"/><ellipse cx="1249.1" cy="467" fill="#A9DCDF" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1251.2875,468.7656 L1247.1469,468.7656 L1246.725,469.7969 L1247.1469,469.7969 Q1247.7563,469.7969 1248.0219,470.0313 Q1248.2875,470.2656 1248.2875,470.6563 Q1248.2875,471.0313 1248.0219,471.2656 Q1247.7563,471.5 1247.1469,471.5 L1244.85,471.5 Q1244.2406,471.5 1243.9828,471.2656 Q1243.725,471.0313 1243.725,470.6406 Q1243.725,470.2656 1243.9984,470.0234 Q1244.2719,469.7813 1244.8969,469.7969 L1247.5688,463.1406 L1246.4594,463.1406 Q1245.85,463.1406 1245.5844,462.9063 Q1245.3188,462.6719 1245.3188,462.2813 Q1245.3188,461.9063 1245.5844,461.6719 Q1245.85,461.4375 1246.4594,461.4375 L1250.1313,461.4375 L1253.5219,469.7969 Q1254.1156,469.7969 1254.3031,469.9375 Q1254.6938,470.2031 1254.6938,470.6563 Q1254.6938,471.0313 1254.4359,471.2656 Q1254.1781,471.5 1253.5688,471.5 L1251.2719,471.5 Q1250.6625,471.5 1250.3969,471.2656 Q1250.1313,471.0313 1250.1313,470.6406 Q1250.1313,470.2656 1250.3969,470.0313 Q1250.6625,469.7969 1251.2719,469.7969 L1251.6938,469.7969 L1251.2875,468.7656 Z M1250.5688,467.0625 L1249.2094,463.6875 L1247.8344,467.0625 L1250.5688,467.0625 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" font-style="italic" lengthAdjust="spacing" textLength="131" x="1265.9" y="473.8291">ModuleInterface</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1222.5" x2="1411.5" y1="483" y2="483"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1222.5" x2="1411.5" y1="491" y2="491"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="57" x="1227.5" y="508.3608">forward()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="179" x="1227.5" y="524.4595">get_optimizers_schedulers()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="142" x="1227.5" y="540.5581">get_train_dataloader()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="138" x="1227.5" y="556.6567">get_val_dataloaders()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="73" x="1227.5" y="572.7554">train_step()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="62" x="1227.5" y="588.854">val_step()</text><!--MD5=[108582c5afb2f640e07c746d3eb8ea51]
class marlin.core.trainer_backend.TrainerBackend--><rect codeLine="53" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="160.6904" id="marlin.core.trainer_backend.TrainerBackend" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="203" x="113.5" y="443"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="203" x="113.5" y="443"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="203" x="113.5" y="470"/><rect codeLine="53" fill="none" height="160.6904" id="marlin.core.trainer_backend.TrainerBackend" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="203" x="113.5" y="443"/><ellipse cx="147.85" cy="459" fill="#A9DCDF" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M150.0375,460.7656 L145.8969,460.7656 L145.475,461.7969 L145.8969,461.7969 Q146.5063,461.7969 146.7719,462.0313 Q147.0375,462.2656 147.0375,462.6563 Q147.0375,463.0313 146.7719,463.2656 Q146.5063,463.5 145.8969,463.5 L143.6,463.5 Q142.9906,463.5 142.7328,463.2656 Q142.475,463.0313 142.475,462.6406 Q142.475,462.2656 142.7484,462.0234 Q143.0219,461.7813 143.6469,461.7969 L146.3188,455.1406 L145.2094,455.1406 Q144.6,455.1406 144.3344,454.9063 Q144.0688,454.6719 144.0688,454.2813 Q144.0688,453.9063 144.3344,453.6719 Q144.6,453.4375 145.2094,453.4375 L148.8813,453.4375 L152.2719,461.7969 Q152.8656,461.7969 153.0531,461.9375 Q153.4438,462.2031 153.4438,462.6563 Q153.4438,463.0313 153.1859,463.2656 Q152.9281,463.5 152.3188,463.5 L150.0219,463.5 Q149.4125,463.5 149.1469,463.2656 Q148.8813,463.0313 148.8813,462.6406 Q148.8813,462.2656 149.1469,462.0313 Q149.4125,461.7969 150.0219,461.7969 L150.4438,461.7969 L150.0375,460.7656 Z M149.3188,459.0625 L147.9594,455.6875 L146.5844,459.0625 L149.3188,459.0625 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" font-style="italic" lengthAdjust="spacing" textLength="128" x="166.15" y="465.8291">TrainerBackend</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="114.5" x2="315.5" y1="475" y2="475"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="114.5" x2="315.5" y1="483" y2="483"/><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="28" x="119.5" y="500.3608">init()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="57" x="119.5" y="516.4595">train_dl()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="77" x="119.5" y="532.5581">validate_dl()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="161" x="119.5" y="548.6567">get_batches_completed()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="191" x="119.5" y="564.7554">get_global_steps_completed()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="96" x="119.5" y="580.854">train_sampler()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="85" x="119.5" y="596.9526">val_sampler()</text><path d="M352,507 L352,519.5 L316.64,523.5 L352,527.5 L352,539.7031 A5,5 0 0 0 357,544.7031 L491,544.7031 A5,5 0 0 0 496,539.7031 L496,512 L486,502 L357,502 A5,5 0 0 0 352,507 " fill="#FBFB77" filter="url(#f9ksvey7waxum)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M486,502 L486,509.5 A2.5,2.5 0 0 0 488.5,512 L496,512 L486,502 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="358" y="520.4951">Users can implement</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="102" x="358" y="536.8467">their own Trainers</text><!--MD5=[fc4ee2f67a665ed852cd6d2b97a6ef99]
class marlin.core.trainer_backend.SingleProcess--><rect codeLine="63" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="64.0986" id="marlin.core.trainer_backend.SingleProcess" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="155" x="371.5" y="295"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="155" x="371.5" y="295"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="155" x="371.5" y="322"/><rect codeLine="63" fill="none" height="64.0986" id="marlin.core.trainer_backend.SingleProcess" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="155" x="371.5" y="295"/><ellipse cx="390.1" cy="311" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M392.8656,306.875 Q393.0219,306.6563 393.2094,306.5469 Q393.3969,306.4375 393.6156,306.4375 Q393.9906,306.4375 394.225,306.6953 Q394.4594,306.9531 394.4594,307.5625 L394.4594,309.0156 Q394.4594,309.625 394.225,309.8906 Q393.9906,310.1563 393.6156,310.1563 Q393.2719,310.1563 393.0688,309.9531 Q392.8656,309.7656 392.7563,309.25 Q392.7094,308.8906 392.5219,308.7031 Q392.1938,308.3281 391.5844,308.1094 Q390.975,307.8906 390.35,307.8906 Q389.5844,307.8906 388.9516,308.2188 Q388.3188,308.5469 387.8266,309.2969 Q387.3344,310.0469 387.3344,311.0781 L387.3344,312.1719 Q387.3344,313.4063 388.225,314.2266 Q389.1156,315.0469 390.7094,315.0469 Q391.6469,315.0469 392.3031,314.7969 Q392.6938,314.6406 393.1156,314.2031 Q393.3813,313.9375 393.5297,313.8594 Q393.6781,313.7813 393.8813,313.7813 Q394.2094,313.7813 394.4672,314.0391 Q394.725,314.2969 394.725,314.6406 Q394.725,314.9844 394.3813,315.3906 Q393.8813,315.9688 393.0844,316.2969 Q392.0063,316.75 390.7094,316.75 Q389.1938,316.75 387.9906,316.125 Q387.0063,315.625 386.3188,314.5547 Q385.6313,313.4844 385.6313,312.2031 L385.6313,311.0469 Q385.6313,309.7188 386.2484,308.5703 Q386.8656,307.4219 387.9594,306.8047 Q389.0531,306.1875 390.2875,306.1875 Q391.0219,306.1875 391.6703,306.3516 Q392.3188,306.5156 392.8656,306.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="115" x="404.9" y="317.8291">SingleProcess</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="372.5" x2="525.5" y1="327" y2="327"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="143" x="377.5" y="344.3608">ModuleInterface model</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="372.5" x2="525.5" y1="351.0986" y2="351.0986"/><!--MD5=[d6e29496e36685dcdfced83c2426c7ea]
class marlin.core.trainer_backend.AbstractTrainerBackendDecorator--><rect codeLine="66" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="marlin.core.trainer_backend.AbstractTrainerBackendDecorator" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="304" x="32" y="303"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="304" x="32" y="303"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="304" x="32" y="330"/><rect codeLine="66" fill="none" height="48" id="marlin.core.trainer_backend.AbstractTrainerBackendDecorator" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="304" x="32" y="303"/><ellipse cx="47" cy="319" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M49.7656,314.875 Q49.9219,314.6563 50.1094,314.5469 Q50.2969,314.4375 50.5156,314.4375 Q50.8906,314.4375 51.125,314.6953 Q51.3594,314.9531 51.3594,315.5625 L51.3594,317.0156 Q51.3594,317.625 51.125,317.8906 Q50.8906,318.1563 50.5156,318.1563 Q50.1719,318.1563 49.9688,317.9531 Q49.7656,317.7656 49.6563,317.25 Q49.6094,316.8906 49.4219,316.7031 Q49.0938,316.3281 48.4844,316.1094 Q47.875,315.8906 47.25,315.8906 Q46.4844,315.8906 45.8516,316.2188 Q45.2188,316.5469 44.7266,317.2969 Q44.2344,318.0469 44.2344,319.0781 L44.2344,320.1719 Q44.2344,321.4063 45.125,322.2266 Q46.0156,323.0469 47.6094,323.0469 Q48.5469,323.0469 49.2031,322.7969 Q49.5938,322.6406 50.0156,322.2031 Q50.2813,321.9375 50.4297,321.8594 Q50.5781,321.7813 50.7813,321.7813 Q51.1094,321.7813 51.3672,322.0391 Q51.625,322.2969 51.625,322.6406 Q51.625,322.9844 51.2813,323.3906 Q50.7813,323.9688 49.9844,324.2969 Q48.9063,324.75 47.6094,324.75 Q46.0938,324.75 44.8906,324.125 Q43.9063,323.625 43.2188,322.5547 Q42.5313,321.4844 42.5313,320.2031 L42.5313,319.0469 Q42.5313,317.7188 43.1484,316.5703 Q43.7656,315.4219 44.8594,314.8047 Q45.9531,314.1875 47.1875,314.1875 Q47.9219,314.1875 48.5703,314.3516 Q49.2188,314.5156 49.7656,314.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="272" x="61" y="325.8291">AbstractTrainerBackendDecorator</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="33" x2="335" y1="335" y2="335"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="33" x2="335" y1="343" y2="343"/><!--MD5=[0ed079f3e4cc970e0951e7aeb448127b]
class marlin.core.trainer_backend.SingleProcessAmp--><rect codeLine="67" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="96.2959" id="marlin.core.trainer_backend.SingleProcessAmp" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="182" x="345" y="82.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="182" x="345" y="82.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="182" x="345" y="109.5"/><rect codeLine="67" fill="none" height="96.2959" id="marlin.core.trainer_backend.SingleProcessAmp" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="182" x="345" y="82.5"/><ellipse cx="360" cy="98.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M362.7656,94.375 Q362.9219,94.1563 363.1094,94.0469 Q363.2969,93.9375 363.5156,93.9375 Q363.8906,93.9375 364.125,94.1953 Q364.3594,94.4531 364.3594,95.0625 L364.3594,96.5156 Q364.3594,97.125 364.125,97.3906 Q363.8906,97.6563 363.5156,97.6563 Q363.1719,97.6563 362.9688,97.4531 Q362.7656,97.2656 362.6563,96.75 Q362.6094,96.3906 362.4219,96.2031 Q362.0938,95.8281 361.4844,95.6094 Q360.875,95.3906 360.25,95.3906 Q359.4844,95.3906 358.8516,95.7188 Q358.2188,96.0469 357.7266,96.7969 Q357.2344,97.5469 357.2344,98.5781 L357.2344,99.6719 Q357.2344,100.9063 358.125,101.7266 Q359.0156,102.5469 360.6094,102.5469 Q361.5469,102.5469 362.2031,102.2969 Q362.5938,102.1406 363.0156,101.7031 Q363.2813,101.4375 363.4297,101.3594 Q363.5781,101.2813 363.7813,101.2813 Q364.1094,101.2813 364.3672,101.5391 Q364.625,101.7969 364.625,102.1406 Q364.625,102.4844 364.2813,102.8906 Q363.7813,103.4688 362.9844,103.7969 Q361.9063,104.25 360.6094,104.25 Q359.0938,104.25 357.8906,103.625 Q356.9063,103.125 356.2188,102.0547 Q355.5313,100.9844 355.5313,99.7031 L355.5313,98.5469 Q355.5313,97.2188 356.1484,96.0703 Q356.7656,94.9219 357.8594,94.3047 Q358.9531,93.6875 360.1875,93.6875 Q360.9219,93.6875 361.5703,93.8516 Q362.2188,94.0156 362.7656,94.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="150" x="374" y="105.3291">SingleProcessAmp</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="346" x2="526" y1="114.5" y2="114.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="346" x2="526" y1="122.5" y2="122.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="28" x="351" y="139.8608">init()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="57" x="351" y="155.9595">train_dl()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="78" x="351" y="172.0581">validate_dl()</text><!--MD5=[d2fcd058d5217782175da6f28a19851b]
class marlin.core.trainer_backend.DDPTrainerBackend--><rect codeLine="72" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="80.1973" id="marlin.core.trainer_backend.DDPTrainerBackend" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="85" y="90.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="85" y="90.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="85" y="117.5"/><rect codeLine="72" fill="none" height="80.1973" id="marlin.core.trainer_backend.DDPTrainerBackend" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="85" y="90.5"/><ellipse cx="100" cy="106.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M102.7656,102.375 Q102.9219,102.1563 103.1094,102.0469 Q103.2969,101.9375 103.5156,101.9375 Q103.8906,101.9375 104.125,102.1953 Q104.3594,102.4531 104.3594,103.0625 L104.3594,104.5156 Q104.3594,105.125 104.125,105.3906 Q103.8906,105.6563 103.5156,105.6563 Q103.1719,105.6563 102.9688,105.4531 Q102.7656,105.2656 102.6563,104.75 Q102.6094,104.3906 102.4219,104.2031 Q102.0938,103.8281 101.4844,103.6094 Q100.875,103.3906 100.25,103.3906 Q99.4844,103.3906 98.8516,103.7188 Q98.2188,104.0469 97.7266,104.7969 Q97.2344,105.5469 97.2344,106.5781 L97.2344,107.6719 Q97.2344,108.9063 98.125,109.7266 Q99.0156,110.5469 100.6094,110.5469 Q101.5469,110.5469 102.2031,110.2969 Q102.5938,110.1406 103.0156,109.7031 Q103.2813,109.4375 103.4297,109.3594 Q103.5781,109.2813 103.7813,109.2813 Q104.1094,109.2813 104.3672,109.5391 Q104.625,109.7969 104.625,110.1406 Q104.625,110.4844 104.2813,110.8906 Q103.7813,111.4688 102.9844,111.7969 Q101.9063,112.25 100.6094,112.25 Q99.0938,112.25 97.8906,111.625 Q96.9063,111.125 96.2188,110.0547 Q95.5313,108.9844 95.5313,107.7031 L95.5313,106.5469 Q95.5313,105.2188 96.1484,104.0703 Q96.7656,102.9219 97.8594,102.3047 Q98.9531,101.6875 100.1875,101.6875 Q100.9219,101.6875 101.5703,101.8516 Q102.2188,102.0156 102.7656,102.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="166" x="114" y="113.3291">DDPTrainerBackend</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="86" x2="282" y1="122.5" y2="122.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="86" x2="282" y1="130.5" y2="130.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="28" x="91" y="147.8608">init()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="165" x="91" y="163.9595">setup_distributed_model()</text><!--MD5=[95e7768ce0be7cbb27a4c2a18d83dad6]
class marlin.core.trainer.TrainerArgs--><rect codeLine="81" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="96.2959" id="marlin.core.trainer.TrainerArgs" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="209" x="975.5" y="279"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="209" x="975.5" y="279"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="209" x="975.5" y="306"/><rect codeLine="81" fill="none" height="96.2959" id="marlin.core.trainer.TrainerArgs" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="209" x="975.5" y="279"/><ellipse cx="1028.75" cy="295" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1031.5156,290.875 Q1031.6719,290.6563 1031.8594,290.5469 Q1032.0469,290.4375 1032.2656,290.4375 Q1032.6406,290.4375 1032.875,290.6953 Q1033.1094,290.9531 1033.1094,291.5625 L1033.1094,293.0156 Q1033.1094,293.625 1032.875,293.8906 Q1032.6406,294.1563 1032.2656,294.1563 Q1031.9219,294.1563 1031.7188,293.9531 Q1031.5156,293.7656 1031.4063,293.25 Q1031.3594,292.8906 1031.1719,292.7031 Q1030.8438,292.3281 1030.2344,292.1094 Q1029.625,291.8906 1029,291.8906 Q1028.2344,291.8906 1027.6016,292.2188 Q1026.9688,292.5469 1026.4766,293.2969 Q1025.9844,294.0469 1025.9844,295.0781 L1025.9844,296.1719 Q1025.9844,297.4063 1026.875,298.2266 Q1027.7656,299.0469 1029.3594,299.0469 Q1030.2969,299.0469 1030.9531,298.7969 Q1031.3438,298.6406 1031.7656,298.2031 Q1032.0313,297.9375 1032.1797,297.8594 Q1032.3281,297.7813 1032.5313,297.7813 Q1032.8594,297.7813 1033.1172,298.0391 Q1033.375,298.2969 1033.375,298.6406 Q1033.375,298.9844 1033.0313,299.3906 Q1032.5313,299.9688 1031.7344,300.2969 Q1030.6563,300.75 1029.3594,300.75 Q1027.8438,300.75 1026.6406,300.125 Q1025.6563,299.625 1024.9688,298.5547 Q1024.2813,297.4844 1024.2813,296.2031 L1024.2813,295.0469 Q1024.2813,293.7188 1024.8984,292.5703 Q1025.5156,291.4219 1026.6094,290.8047 Q1027.7031,290.1875 1028.9375,290.1875 Q1029.6719,290.1875 1030.3203,290.3516 Q1030.9688,290.5156 1031.5156,290.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="94" x="1049.25" y="301.8291">TrainerArgs</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="976.5" x2="1183.5" y1="311" y2="311"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="197" x="981.5" y="328.3608">DefaultCheckpointerArguments</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="85" x="981.5" y="344.4595">WriterInitArgs</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="72" x="981.5" y="360.5581">StatInitArgs</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="976.5" x2="1183.5" y1="367.2959" y2="367.2959"/><path d="M1007.5,114 L1007.5,146.7031 A5,5 0 0 0 1012.5,151.7031 L1090.29,151.7031 L1083.88,278.84 L1098.29,151.7031 L1179.5,151.7031 A5,5 0 0 0 1184.5,146.7031 L1184.5,119 L1174.5,109 L1012.5,109 A5,5 0 0 0 1007.5,114 " fill="#FBFB77" filter="url(#f9ksvey7waxum)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1174.5,109 L1174.5,116.5 A2.5,2.5 0 0 0 1177,119 L1184.5,119 L1174.5,109 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="1013.5" y="127.4951">Customize these and other</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="1017.5" y="143.8467">args from config.yaml</text><!--MD5=[970835171629d35d9a604eb5ccca239a]
class marlin.core.trainer.AbstractTrainer--><rect codeLine="87" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="80.1973" id="marlin.core.trainer.AbstractTrainer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="156" x="784" y="287"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="156" x="784" y="287"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="156" x="784" y="314"/><rect codeLine="87" fill="none" height="80.1973" id="marlin.core.trainer.AbstractTrainer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="156" x="784" y="287"/><ellipse cx="799" cy="303" fill="#A9DCDF" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M801.1875,304.7656 L797.0469,304.7656 L796.625,305.7969 L797.0469,305.7969 Q797.6563,305.7969 797.9219,306.0313 Q798.1875,306.2656 798.1875,306.6563 Q798.1875,307.0313 797.9219,307.2656 Q797.6563,307.5 797.0469,307.5 L794.75,307.5 Q794.1406,307.5 793.8828,307.2656 Q793.625,307.0313 793.625,306.6406 Q793.625,306.2656 793.8984,306.0234 Q794.1719,305.7813 794.7969,305.7969 L797.4688,299.1406 L796.3594,299.1406 Q795.75,299.1406 795.4844,298.9063 Q795.2188,298.6719 795.2188,298.2813 Q795.2188,297.9063 795.4844,297.6719 Q795.75,297.4375 796.3594,297.4375 L800.0313,297.4375 L803.4219,305.7969 Q804.0156,305.7969 804.2031,305.9375 Q804.5938,306.2031 804.5938,306.6563 Q804.5938,307.0313 804.3359,307.2656 Q804.0781,307.5 803.4688,307.5 L801.1719,307.5 Q800.5625,307.5 800.2969,307.2656 Q800.0313,307.0313 800.0313,306.6406 Q800.0313,306.2656 800.2969,306.0313 Q800.5625,305.7969 801.1719,305.7969 L801.5938,305.7969 L801.1875,304.7656 Z M800.4688,303.0625 L799.1094,299.6875 L797.7344,303.0625 L800.4688,303.0625 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" font-style="italic" lengthAdjust="spacing" textLength="124" x="813" y="309.8291">AbstractTrainer</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="785" x2="939" y1="319" y2="319"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="785" x2="939" y1="327" y2="327"/><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="38" x="790" y="344.3608">train()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="58" x="790" y="360.4595">validate()</text><!--MD5=[fb4cf862030686f54d8a467f36092fea]
class marlin.core.trainer.Trainer--><rect codeLine="91" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="176.7891" id="marlin.core.trainer.Trainer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="233" x="739.5" y="42"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="233" x="739.5" y="42"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="233" x="739.5" y="69"/><rect codeLine="91" fill="none" height="176.7891" id="marlin.core.trainer.Trainer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="233" x="739.5" y="42"/><ellipse cx="822.75" cy="58" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M825.5156,53.875 Q825.6719,53.6563 825.8594,53.5469 Q826.0469,53.4375 826.2656,53.4375 Q826.6406,53.4375 826.875,53.6953 Q827.1094,53.9531 827.1094,54.5625 L827.1094,56.0156 Q827.1094,56.625 826.875,56.8906 Q826.6406,57.1563 826.2656,57.1563 Q825.9219,57.1563 825.7188,56.9531 Q825.5156,56.7656 825.4063,56.25 Q825.3594,55.8906 825.1719,55.7031 Q824.8438,55.3281 824.2344,55.1094 Q823.625,54.8906 823,54.8906 Q822.2344,54.8906 821.6016,55.2188 Q820.9688,55.5469 820.4766,56.2969 Q819.9844,57.0469 819.9844,58.0781 L819.9844,59.1719 Q819.9844,60.4063 820.875,61.2266 Q821.7656,62.0469 823.3594,62.0469 Q824.2969,62.0469 824.9531,61.7969 Q825.3438,61.6406 825.7656,61.2031 Q826.0313,60.9375 826.1797,60.8594 Q826.3281,60.7813 826.5313,60.7813 Q826.8594,60.7813 827.1172,61.0391 Q827.375,61.2969 827.375,61.6406 Q827.375,61.9844 827.0313,62.3906 Q826.5313,62.9688 825.7344,63.2969 Q824.6563,63.75 823.3594,63.75 Q821.8438,63.75 820.6406,63.125 Q819.6563,62.625 818.9688,61.5547 Q818.2813,60.4844 818.2813,59.2031 L818.2813,58.0469 Q818.2813,56.7188 818.8984,55.5703 Q819.5156,54.4219 820.6094,53.8047 Q821.7031,53.1875 822.9375,53.1875 Q823.6719,53.1875 824.3203,53.3516 Q824.9688,53.5156 825.5156,53.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="58" x="843.25" y="64.8291">Trainer</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="740.5" x2="971.5" y1="74" y2="74"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="208" x="745.5" y="91.3608">TrainerBackend trainer_backend</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="151" x="745.5" y="107.4595">ModuleInterface module</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="221" x="745.5" y="123.5581">AbstractCheckpointer checkpointer</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="63" x="745.5" y="139.6567">optimizers</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="69" x="745.5" y="155.7554">schedulers</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="740.5" x2="971.5" y1="162.4932" y2="162.4932"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="38" x="745.5" y="179.854">train()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="59" x="745.5" y="195.9526">validate()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="113" x="745.5" y="212.0513">load_checkpoint()</text><!--MD5=[ea5eb9b26a5dfdaad042277d3391ce8c]
class marlin.core.data_interface.DataProcessor--><rect codeLine="162" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="80.1973" id="marlin.core.data_interface.DataProcessor" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="151" x="1821.5" y="885"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="151" x="1821.5" y="885"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="151" x="1821.5" y="912"/><rect codeLine="162" fill="none" height="80.1973" id="marlin.core.data_interface.DataProcessor" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="151" x="1821.5" y="885"/><ellipse cx="1836.5" cy="901" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1839.2656,896.875 Q1839.4219,896.6563 1839.6094,896.5469 Q1839.7969,896.4375 1840.0156,896.4375 Q1840.3906,896.4375 1840.625,896.6953 Q1840.8594,896.9531 1840.8594,897.5625 L1840.8594,899.0156 Q1840.8594,899.625 1840.625,899.8906 Q1840.3906,900.1563 1840.0156,900.1563 Q1839.6719,900.1563 1839.4688,899.9531 Q1839.2656,899.7656 1839.1563,899.25 Q1839.1094,898.8906 1838.9219,898.7031 Q1838.5938,898.3281 1837.9844,898.1094 Q1837.375,897.8906 1836.75,897.8906 Q1835.9844,897.8906 1835.3516,898.2188 Q1834.7188,898.5469 1834.2266,899.2969 Q1833.7344,900.0469 1833.7344,901.0781 L1833.7344,902.1719 Q1833.7344,903.4063 1834.625,904.2266 Q1835.5156,905.0469 1837.1094,905.0469 Q1838.0469,905.0469 1838.7031,904.7969 Q1839.0938,904.6406 1839.5156,904.2031 Q1839.7813,903.9375 1839.9297,903.8594 Q1840.0781,903.7813 1840.2813,903.7813 Q1840.6094,903.7813 1840.8672,904.0391 Q1841.125,904.2969 1841.125,904.6406 Q1841.125,904.9844 1840.7813,905.3906 Q1840.2813,905.9688 1839.4844,906.2969 Q1838.4063,906.75 1837.1094,906.75 Q1835.5938,906.75 1834.3906,906.125 Q1833.4063,905.625 1832.7188,904.5547 Q1832.0313,903.4844 1832.0313,902.2031 L1832.0313,901.0469 Q1832.0313,899.7188 1832.6484,898.5703 Q1833.2656,897.4219 1834.3594,896.8047 Q1835.4531,896.1875 1836.6875,896.1875 Q1837.4219,896.1875 1838.0703,896.3516 Q1838.7188,896.5156 1839.2656,896.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="119" x="1850.5" y="907.8291">DataProcessor</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1822.5" x2="1971.5" y1="917" y2="917"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1822.5" x2="1971.5" y1="925" y2="925"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="58" x="1827.5" y="942.3608">analyze()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="60" x="1827.5" y="958.4595">process()</text><!--MD5=[b53a530723e7efc46d1ab04dcf12ca6d]
class marlin.core.data_interface.DataInterface--><rect codeLine="111" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="144.5918" id="marlin.core.data_interface.DataInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="145" x="1821.5" y="680"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="145" x="1821.5" y="680"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="145" x="1821.5" y="707"/><rect codeLine="111" fill="none" height="144.5918" id="marlin.core.data_interface.DataInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="145" x="1821.5" y="680"/><ellipse cx="1838.75" cy="696" fill="#A9DCDF" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1840.9375,697.7656 L1836.7969,697.7656 L1836.375,698.7969 L1836.7969,698.7969 Q1837.4063,698.7969 1837.6719,699.0313 Q1837.9375,699.2656 1837.9375,699.6563 Q1837.9375,700.0313 1837.6719,700.2656 Q1837.4063,700.5 1836.7969,700.5 L1834.5,700.5 Q1833.8906,700.5 1833.6328,700.2656 Q1833.375,700.0313 1833.375,699.6406 Q1833.375,699.2656 1833.6484,699.0234 Q1833.9219,698.7813 1834.5469,698.7969 L1837.2188,692.1406 L1836.1094,692.1406 Q1835.5,692.1406 1835.2344,691.9063 Q1834.9688,691.6719 1834.9688,691.2813 Q1834.9688,690.9063 1835.2344,690.6719 Q1835.5,690.4375 1836.1094,690.4375 L1839.7813,690.4375 L1843.1719,698.7969 Q1843.7656,698.7969 1843.9531,698.9375 Q1844.3438,699.2031 1844.3438,699.6563 Q1844.3438,700.0313 1844.0859,700.2656 Q1843.8281,700.5 1843.2188,700.5 L1840.9219,700.5 Q1840.3125,700.5 1840.0469,700.2656 Q1839.7813,700.0313 1839.7813,699.6406 Q1839.7813,699.2656 1840.0469,699.0313 Q1840.3125,698.7969 1840.9219,698.7969 L1841.3438,698.7969 L1840.9375,697.7656 Z M1840.2188,696.0625 L1838.8594,692.6875 L1837.4844,696.0625 L1840.2188,696.0625 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" font-style="italic" lengthAdjust="spacing" textLength="108" x="1853.25" y="702.8291">DataInterface</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1822.5" x2="1965.5" y1="712" y2="712"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1822.5" x2="1965.5" y1="720" y2="720"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="107" x="1827.5" y="737.3608">setup_datasets()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="96" x="1827.5" y="753.4595">process_data()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="133" x="1827.5" y="769.5581">multi_process_data()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="121" x="1827.5" y="785.6567">get_train_dataset()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="110" x="1827.5" y="801.7554">get_val_dataset()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="116" x="1827.5" y="817.854">get_test_dataset()</text><!--MD5=[040b9a19fe2674663ae7132d99eb431b]
class marlin.core.utils.checkpoint_utils.Checkpoint--><rect codeLine="124" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="96.2959" id="marlin.core.utils.checkpoint_utils.Checkpoint" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="188" x="901" y="475.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="188" x="901" y="475.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="188" x="901" y="502.5"/><rect codeLine="124" fill="none" height="96.2959" id="marlin.core.utils.checkpoint_utils.Checkpoint" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="188" x="901" y="475.5"/><ellipse cx="945.75" cy="491.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M948.5156,487.375 Q948.6719,487.1563 948.8594,487.0469 Q949.0469,486.9375 949.2656,486.9375 Q949.6406,486.9375 949.875,487.1953 Q950.1094,487.4531 950.1094,488.0625 L950.1094,489.5156 Q950.1094,490.125 949.875,490.3906 Q949.6406,490.6563 949.2656,490.6563 Q948.9219,490.6563 948.7188,490.4531 Q948.5156,490.2656 948.4063,489.75 Q948.3594,489.3906 948.1719,489.2031 Q947.8438,488.8281 947.2344,488.6094 Q946.625,488.3906 946,488.3906 Q945.2344,488.3906 944.6016,488.7188 Q943.9688,489.0469 943.4766,489.7969 Q942.9844,490.5469 942.9844,491.5781 L942.9844,492.6719 Q942.9844,493.9063 943.875,494.7266 Q944.7656,495.5469 946.3594,495.5469 Q947.2969,495.5469 947.9531,495.2969 Q948.3438,495.1406 948.7656,494.7031 Q949.0313,494.4375 949.1797,494.3594 Q949.3281,494.2813 949.5313,494.2813 Q949.8594,494.2813 950.1172,494.5391 Q950.375,494.7969 950.375,495.1406 Q950.375,495.4844 950.0313,495.8906 Q949.5313,496.4688 948.7344,496.7969 Q947.6563,497.25 946.3594,497.25 Q944.8438,497.25 943.6406,496.625 Q942.6563,496.125 941.9688,495.0547 Q941.2813,493.9844 941.2813,492.7031 L941.2813,491.5469 Q941.2813,490.2188 941.8984,489.0703 Q942.5156,487.9219 943.6094,487.3047 Q944.7031,486.6875 945.9375,486.6875 Q946.6719,486.6875 947.3203,486.8516 Q947.9688,487.0156 948.5156,487.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="90" x="966.25" y="498.3291">Checkpoint</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="902" x2="1088" y1="507.5" y2="507.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="176" x="907" y="524.8608">Dict module_interface_state</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="108" x="907" y="540.9595">Dict trainer_state</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="170" x="907" y="557.0581">Dict trainer_backend_state</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="902" x2="1088" y1="563.7959" y2="563.7959"/><!--MD5=[2252d0693e2ce261cbd7cd7374be9c06]
class marlin.core.utils.checkpoint_utils.AbstractCheckpointer--><rect codeLine="130" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="96.2959" id="marlin.core.utils.checkpoint_utils.AbstractCheckpointer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="205" x="898.5" y="704.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="205" x="898.5" y="704.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="205" x="898.5" y="731.5"/><rect codeLine="130" fill="none" height="96.2959" id="marlin.core.utils.checkpoint_utils.AbstractCheckpointer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="205" x="898.5" y="704.5"/><ellipse cx="913.5" cy="720.5" fill="#A9DCDF" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M915.6875,722.2656 L911.5469,722.2656 L911.125,723.2969 L911.5469,723.2969 Q912.1563,723.2969 912.4219,723.5313 Q912.6875,723.7656 912.6875,724.1563 Q912.6875,724.5313 912.4219,724.7656 Q912.1563,725 911.5469,725 L909.25,725 Q908.6406,725 908.3828,724.7656 Q908.125,724.5313 908.125,724.1406 Q908.125,723.7656 908.3984,723.5234 Q908.6719,723.2813 909.2969,723.2969 L911.9688,716.6406 L910.8594,716.6406 Q910.25,716.6406 909.9844,716.4063 Q909.7188,716.1719 909.7188,715.7813 Q909.7188,715.4063 909.9844,715.1719 Q910.25,714.9375 910.8594,714.9375 L914.5313,714.9375 L917.9219,723.2969 Q918.5156,723.2969 918.7031,723.4375 Q919.0938,723.7031 919.0938,724.1563 Q919.0938,724.5313 918.8359,724.7656 Q918.5781,725 917.9688,725 L915.6719,725 Q915.0625,725 914.7969,724.7656 Q914.5313,724.5313 914.5313,724.1406 Q914.5313,723.7656 914.7969,723.5313 Q915.0625,723.2969 915.6719,723.2969 L916.0938,723.2969 L915.6875,722.2656 Z M914.9688,720.5625 L913.6094,717.1875 L912.2344,720.5625 L914.9688,720.5625 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" font-style="italic" lengthAdjust="spacing" textLength="173" x="927.5" y="727.3291">AbstractCheckpointer</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="899.5" x2="1102.5" y1="736.5" y2="736.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="899.5" x2="1102.5" y1="744.5" y2="744.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="39" x="904.5" y="761.8608">save()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="85" x="904.5" y="777.9595">save_model()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" font-style="italic" lengthAdjust="spacing" textLength="37" x="904.5" y="794.0581">load()</text><!--MD5=[b02852ef2c741c027c1f5ae80fdf3120]
class marlin.core.utils.checkpoint_utils.DefaultCheckpointer--><rect codeLine="136" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="64.0986" id="marlin.core.utils.checkpoint_utils.DefaultCheckpointer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="241" x="610.5" y="491.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="241" x="610.5" y="491.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="241" x="610.5" y="518.5"/><rect codeLine="136" fill="none" height="64.0986" id="marlin.core.utils.checkpoint_utils.DefaultCheckpointer" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="241" x="610.5" y="491.5"/><ellipse cx="646.2" cy="507.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M648.9656,503.375 Q649.1219,503.1563 649.3094,503.0469 Q649.4969,502.9375 649.7156,502.9375 Q650.0906,502.9375 650.325,503.1953 Q650.5594,503.4531 650.5594,504.0625 L650.5594,505.5156 Q650.5594,506.125 650.325,506.3906 Q650.0906,506.6563 649.7156,506.6563 Q649.3719,506.6563 649.1688,506.4531 Q648.9656,506.2656 648.8563,505.75 Q648.8094,505.3906 648.6219,505.2031 Q648.2938,504.8281 647.6844,504.6094 Q647.075,504.3906 646.45,504.3906 Q645.6844,504.3906 645.0516,504.7188 Q644.4188,505.0469 643.9266,505.7969 Q643.4344,506.5469 643.4344,507.5781 L643.4344,508.6719 Q643.4344,509.9063 644.325,510.7266 Q645.2156,511.5469 646.8094,511.5469 Q647.7469,511.5469 648.4031,511.2969 Q648.7938,511.1406 649.2156,510.7031 Q649.4813,510.4375 649.6297,510.3594 Q649.7781,510.2813 649.9813,510.2813 Q650.3094,510.2813 650.5672,510.5391 Q650.825,510.7969 650.825,511.1406 Q650.825,511.4844 650.4813,511.8906 Q649.9813,512.4688 649.1844,512.7969 Q648.1063,513.25 646.8094,513.25 Q645.2938,513.25 644.0906,512.625 Q643.1063,512.125 642.4188,511.0547 Q641.7313,509.9844 641.7313,508.7031 L641.7313,507.5469 Q641.7313,506.2188 642.3484,505.0703 Q642.9656,503.9219 644.0594,503.3047 Q645.1531,502.6875 646.3875,502.6875 Q647.1219,502.6875 647.7703,502.8516 Q648.4188,503.0156 648.9656,503.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="163" x="664.8" y="514.3291">DefaultCheckpointer</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="611.5" x2="850.5" y1="523.5" y2="523.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="229" x="616.5" y="540.8608">DefaultCheckpointerArguments args</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="611.5" x2="850.5" y1="547.5986" y2="547.5986"/><!--MD5=[be60fa5ba1608a93162d5c45eef3d101]
class marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments--><rect fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="280" x="583" y="728.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="280" x="583" y="728.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="280" x="583" y="755.5"/><rect fill="none" height="48" id="marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="280" x="583" y="728.5"/><ellipse cx="598" cy="744.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M600.7656,740.375 Q600.9219,740.1563 601.1094,740.0469 Q601.2969,739.9375 601.5156,739.9375 Q601.8906,739.9375 602.125,740.1953 Q602.3594,740.4531 602.3594,741.0625 L602.3594,742.5156 Q602.3594,743.125 602.125,743.3906 Q601.8906,743.6563 601.5156,743.6563 Q601.1719,743.6563 600.9688,743.4531 Q600.7656,743.2656 600.6563,742.75 Q600.6094,742.3906 600.4219,742.2031 Q600.0938,741.8281 599.4844,741.6094 Q598.875,741.3906 598.25,741.3906 Q597.4844,741.3906 596.8516,741.7188 Q596.2188,742.0469 595.7266,742.7969 Q595.2344,743.5469 595.2344,744.5781 L595.2344,745.6719 Q595.2344,746.9063 596.125,747.7266 Q597.0156,748.5469 598.6094,748.5469 Q599.5469,748.5469 600.2031,748.2969 Q600.5938,748.1406 601.0156,747.7031 Q601.2813,747.4375 601.4297,747.3594 Q601.5781,747.2813 601.7813,747.2813 Q602.1094,747.2813 602.3672,747.5391 Q602.625,747.7969 602.625,748.1406 Q602.625,748.4844 602.2813,748.8906 Q601.7813,749.4688 600.9844,749.7969 Q599.9063,750.25 598.6094,750.25 Q597.0938,750.25 595.8906,749.625 Q594.9063,749.125 594.2188,748.0547 Q593.5313,746.9844 593.5313,745.7031 L593.5313,744.5469 Q593.5313,743.2188 594.1484,742.0703 Q594.7656,740.9219 595.8594,740.3047 Q596.9531,739.6875 598.1875,739.6875 Q598.9219,739.6875 599.5703,739.8516 Q600.2188,740.0156 600.7656,740.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="248" x="612" y="751.3291">DefaultCheckpointerArguments</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="584" x2="862" y1="760.5" y2="760.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="584" x2="862" y1="768.5" y2="768.5"/><!--MD5=[d7577457b3c392bfe2e72e00452e5658]
class UserDataProcessor--><rect codeLine="160" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="48" id="UserDataProcessor" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="189" x="1791.5" y="303"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="189" x="1791.5" y="303"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="189" x="1791.5" y="330"/><rect codeLine="160" fill="none" height="48" id="UserDataProcessor" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="189" x="1791.5" y="303"/><ellipse cx="1806.5" cy="319" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1809.2656,314.875 Q1809.4219,314.6563 1809.6094,314.5469 Q1809.7969,314.4375 1810.0156,314.4375 Q1810.3906,314.4375 1810.625,314.6953 Q1810.8594,314.9531 1810.8594,315.5625 L1810.8594,317.0156 Q1810.8594,317.625 1810.625,317.8906 Q1810.3906,318.1563 1810.0156,318.1563 Q1809.6719,318.1563 1809.4688,317.9531 Q1809.2656,317.7656 1809.1563,317.25 Q1809.1094,316.8906 1808.9219,316.7031 Q1808.5938,316.3281 1807.9844,316.1094 Q1807.375,315.8906 1806.75,315.8906 Q1805.9844,315.8906 1805.3516,316.2188 Q1804.7188,316.5469 1804.2266,317.2969 Q1803.7344,318.0469 1803.7344,319.0781 L1803.7344,320.1719 Q1803.7344,321.4063 1804.625,322.2266 Q1805.5156,323.0469 1807.1094,323.0469 Q1808.0469,323.0469 1808.7031,322.7969 Q1809.0938,322.6406 1809.5156,322.2031 Q1809.7813,321.9375 1809.9297,321.8594 Q1810.0781,321.7813 1810.2813,321.7813 Q1810.6094,321.7813 1810.8672,322.0391 Q1811.125,322.2969 1811.125,322.6406 Q1811.125,322.9844 1810.7813,323.3906 Q1810.2813,323.9688 1809.4844,324.2969 Q1808.4063,324.75 1807.1094,324.75 Q1805.5938,324.75 1804.3906,324.125 Q1803.4063,323.625 1802.7188,322.5547 Q1802.0313,321.4844 1802.0313,320.2031 L1802.0313,319.0469 Q1802.0313,317.7188 1802.6484,316.5703 Q1803.2656,315.4219 1804.3594,314.8047 Q1805.4531,314.1875 1806.6875,314.1875 Q1807.4219,314.1875 1808.0703,314.3516 Q1808.7188,314.5156 1809.2656,314.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="157" x="1820.5" y="325.8291">UserDataProcessor</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1792.5" x2="1979.5" y1="335" y2="335"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1792.5" x2="1979.5" y1="343" y2="343"/><path d="M1807,114 L1807,146.7031 A5,5 0 0 0 1812,151.7031 L1882,151.7031 L1886,302.94 L1890,151.7031 L1960,151.7031 A5,5 0 0 0 1965,146.7031 L1965,119 L1955,109 L1812,109 A5,5 0 0 0 1807,114 " fill="#FBFB77" filter="url(#f9ksvey7waxum)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1955,109 L1955,116.5 A2.5,2.5 0 0 0 1957.5,119 L1965,119 L1955,109 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137" x="1813" y="127.4951">Implements how to load</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="1813" y="143.8467">and process your data</text><!--MD5=[c6280f34cd235d9d2bdf5f6325285988]
class UserModuleInterface--><rect codeLine="142" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="96.2959" id="UserModuleInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="1224" y="279"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="1224" y="279"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="1224" y="306"/><rect codeLine="142" fill="none" height="96.2959" id="UserModuleInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="198" x="1224" y="279"/><ellipse cx="1239" cy="295" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1241.7656,290.875 Q1241.9219,290.6563 1242.1094,290.5469 Q1242.2969,290.4375 1242.5156,290.4375 Q1242.8906,290.4375 1243.125,290.6953 Q1243.3594,290.9531 1243.3594,291.5625 L1243.3594,293.0156 Q1243.3594,293.625 1243.125,293.8906 Q1242.8906,294.1563 1242.5156,294.1563 Q1242.1719,294.1563 1241.9688,293.9531 Q1241.7656,293.7656 1241.6563,293.25 Q1241.6094,292.8906 1241.4219,292.7031 Q1241.0938,292.3281 1240.4844,292.1094 Q1239.875,291.8906 1239.25,291.8906 Q1238.4844,291.8906 1237.8516,292.2188 Q1237.2188,292.5469 1236.7266,293.2969 Q1236.2344,294.0469 1236.2344,295.0781 L1236.2344,296.1719 Q1236.2344,297.4063 1237.125,298.2266 Q1238.0156,299.0469 1239.6094,299.0469 Q1240.5469,299.0469 1241.2031,298.7969 Q1241.5938,298.6406 1242.0156,298.2031 Q1242.2813,297.9375 1242.4297,297.8594 Q1242.5781,297.7813 1242.7813,297.7813 Q1243.1094,297.7813 1243.3672,298.0391 Q1243.625,298.2969 1243.625,298.6406 Q1243.625,298.9844 1243.2813,299.3906 Q1242.7813,299.9688 1241.9844,300.2969 Q1240.9063,300.75 1239.6094,300.75 Q1238.0938,300.75 1236.8906,300.125 Q1235.9063,299.625 1235.2188,298.5547 Q1234.5313,297.4844 1234.5313,296.2031 L1234.5313,295.0469 Q1234.5313,293.7188 1235.1484,292.5703 Q1235.7656,291.4219 1236.8594,290.8047 Q1237.9531,290.1875 1239.1875,290.1875 Q1239.9219,290.1875 1240.5703,290.3516 Q1241.2188,290.5156 1241.7656,290.875 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="166" x="1253" y="301.8291">UserModuleInterface</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1225" x2="1421" y1="311" y2="311"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="117" x="1230" y="328.3608">DataInterface data</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="147" x="1230" y="344.4595">MarlinAutoModel model</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="152" x="1230" y="360.5581">AutoTokenizer tokenizer</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1225" x2="1421" y1="367.2959" y2="367.2959"/><path d="M1220,114 L1220,146.7031 A5,5 0 0 0 1225,151.7031 L1322.57,151.7031 L1323.97,278.84 L1330.57,151.7031 L1429,151.7031 A5,5 0 0 0 1434,146.7031 L1434,119 L1424,109 L1225,109 A5,5 0 0 0 1220,114 " fill="#FBFB77" filter="url(#f9ksvey7waxum)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M1424,109 L1424,116.5 A2.5,2.5 0 0 0 1426.5,119 L1434,119 L1424,109 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="193" x="1226" y="127.4951">Training recipe - scenario specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="146" x="1230" y="143.8467">and implemented by user</text><!--MD5=[c2402320c84c4a3ae54ea6d7584aeca2]
class UserDataInterface--><rect codeLine="150" fill="#F6F7F9" filter="url(#f9ksvey7waxum)" height="112.3945" id="UserDataInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="177" x="1789.5" y="467.5"/><rect fill="#3F6184" height="32" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="177" x="1789.5" y="467.5"/><rect fill="#3F6184" height="5" style="stroke:#3F6184;stroke-width:2.0;" width="177" x="1789.5" y="494.5"/><rect codeLine="150" fill="none" height="112.3945" id="UserDataInterface" rx="5" ry="5" style="stroke:#3F6184;stroke-width:2.0;" width="177" x="1789.5" y="467.5"/><ellipse cx="1804.5" cy="483.5" fill="#ADD1B2" rx="11" ry="11" style="stroke:#3F6184;stroke-width:1.0;"/><path d="M1807.2656,479.375 Q1807.4219,479.1563 1807.6094,479.0469 Q1807.7969,478.9375 1808.0156,478.9375 Q1808.3906,478.9375 1808.625,479.1953 Q1808.8594,479.4531 1808.8594,480.0625 L1808.8594,481.5156 Q1808.8594,482.125 1808.625,482.3906 Q1808.3906,482.6563 1808.0156,482.6563 Q1807.6719,482.6563 1807.4688,482.4531 Q1807.2656,482.2656 1807.1563,481.75 Q1807.1094,481.3906 1806.9219,481.2031 Q1806.5938,480.8281 1805.9844,480.6094 Q1805.375,480.3906 1804.75,480.3906 Q1803.9844,480.3906 1803.3516,480.7188 Q1802.7188,481.0469 1802.2266,481.7969 Q1801.7344,482.5469 1801.7344,483.5781 L1801.7344,484.6719 Q1801.7344,485.9063 1802.625,486.7266 Q1803.5156,487.5469 1805.1094,487.5469 Q1806.0469,487.5469 1806.7031,487.2969 Q1807.0938,487.1406 1807.5156,486.7031 Q1807.7813,486.4375 1807.9297,486.3594 Q1808.0781,486.2813 1808.2813,486.2813 Q1808.6094,486.2813 1808.8672,486.5391 Q1809.125,486.7969 1809.125,487.1406 Q1809.125,487.4844 1808.7813,487.8906 Q1808.2813,488.4688 1807.4844,488.7969 Q1806.4063,489.25 1805.1094,489.25 Q1803.5938,489.25 1802.3906,488.625 Q1801.4063,488.125 1800.7188,487.0547 Q1800.0313,485.9844 1800.0313,484.7031 L1800.0313,483.5469 Q1800.0313,482.2188 1800.6484,481.0703 Q1801.2656,479.9219 1802.3594,479.3047 Q1803.4531,478.6875 1804.6875,478.6875 Q1805.4219,478.6875 1806.0703,478.8516 Q1806.7188,479.0156 1807.2656,479.375 Z " fill="#000000"/><text fill="#F6F7F9" font-family="Arial" font-size="18" lengthAdjust="spacing" textLength="145" x="1818.5" y="490.3291">UserDataInterface</text><line style="stroke:#3F6184;stroke-width:2.0;" x1="1790.5" x2="1965.5" y1="499.5" y2="499.5"/><line style="stroke:#3F6184;stroke-width:2.0;" x1="1790.5" x2="1965.5" y1="507.5" y2="507.5"/><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="107" x="1795.5" y="524.8608">setup_datasets()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="121" x="1795.5" y="540.9595">get_train_dataset()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="111" x="1795.5" y="557.0581">get_val_dataset()</text><text fill="#2B2B2B" font-family="Arial" font-size="14" lengthAdjust="spacing" textLength="116" x="1795.5" y="573.1567">get_test_dataset()</text><!--MD5=[6c581d8eb47e7088b7c980266c701aac]
reverse link marlin.core.module_interface.ModuleInterface to marlin.core.module_interface.CallbackInterface--><path codeLine="167" d="M1317,616.36 C1317,640.55 1317,666.1 1317,688.4 " fill="none" id="marlin.core.module_interface.ModuleInterface-backto-marlin.core.module_interface.CallbackInterface" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1310,616.01,1317,596.01,1324,616.01,1310,616.01" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[fcdac9c121e22e7a7f20730677c7eaa5]
reverse link marlin.core.module_interface.ModuleInterface to torch.nn.Module--><path codeLine="168" d="M1406.01,610.66 C1413.95,619.07 1421.72,627.6 1429,636 C1455.35,666.42 1482.57,704.26 1499.15,728.16 " fill="none" id="marlin.core.module_interface.ModuleInterface-backto-torch.nn.Module" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1400.91,615.45,1392.1,596.18,1411,605.75,1400.91,615.45" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[9f6f4b49265ca94da576621c319b8770]
reverse link UserModuleInterface to marlin.core.module_interface.ModuleInterface--><path codeLine="169" d="M1320.92,395.27 C1320.37,413.2 1319.77,432.63 1319.21,450.79 " fill="none" id="UserModuleInterface-backto-marlin.core.module_interface.ModuleInterface" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1313.93,394.86,1321.55,375.08,1327.93,395.29,1313.93,394.86" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[5012137b178cc92cefb1b2663b5da591]
reverse link UserDataInterface to marlin.core.data_interface.DataInterface--><path codeLine="170" d="M1883.32,600.02 C1885.13,625.68 1887.15,654.26 1888.93,679.63 " fill="none" id="UserDataInterface-backto-marlin.core.data_interface.DataInterface" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1876.32,600.18,1881.89,579.74,1890.28,599.2,1876.32,600.18" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[9fc6f38dda416970ad86719b007dc042]
reverse link marlin.core.trainer_backend.SingleProcess to marlin.core.trainer_backend.TrainerBackend--><path codeLine="171" d="M395.07,371.36 C381.73,381.09 367.19,390.92 353,399 C345.04,403.53 341.64,401.94 334,407 C318.39,417.33 303.04,429.85 288.82,442.8 " fill="none" id="marlin.core.trainer_backend.SingleProcess-backto-marlin.core.trainer_backend.TrainerBackend" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="391.01,365.65,411.2,359.22,399.43,376.84,391.01,365.65" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a50853ba300e357adfa302705f01134c]
reverse link marlin.core.trainer.Trainer to marlin.core.trainer.AbstractTrainer--><path codeLine="172" d="M859.33,239.32 C859.85,256.17 860.35,272.59 860.78,286.53 " fill="none" id="marlin.core.trainer.Trainer-backto-marlin.core.trainer.AbstractTrainer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="852.32,239.28,858.7,219.08,866.32,238.85,852.32,239.28" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[49399828db68b3b1de20da8f066cf088]
reverse link marlin.core.trainer.Trainer to marlin.core.trainer_backend.SingleProcess--><path codeLine="173" d="M727.21,193.05 C656.27,226.95 571.27,267.57 514.05,294.91 " fill="none" id="marlin.core.trainer.Trainer-backto-marlin.core.trainer_backend.SingleProcess" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="739.37,187.24,732.232,186.2156,728.541,192.4105,735.679,193.4349,739.37,187.24" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[9b2ac120ec9583fd29b91fd012ec07ee]
reverse link marlin.core.trainer_backend.AbstractTrainerBackendDecorator to marlin.core.trainer_backend.TrainerBackend--><path codeLine="174" d="M190.84,370.95 C194.2,392.02 198.36,418.09 202.27,442.64 " fill="none" id="marlin.core.trainer_backend.AbstractTrainerBackendDecorator-backto-marlin.core.trainer_backend.TrainerBackend" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="183.91,371.93,187.68,351.08,197.74,369.72,183.91,371.93" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[8dea97f8b930e84ba025db4429c78ad9]
reverse link marlin.core.trainer_backend.DDPTrainerBackend to marlin.core.trainer_backend.AbstractTrainerBackendDecorator--><path codeLine="175" d="M184,190.99 C184,228.73 184,275.43 184,302.85 " fill="none" id="marlin.core.trainer_backend.DDPTrainerBackend-backto-marlin.core.trainer_backend.AbstractTrainerBackendDecorator" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="177,190.86,184,170.86,191,190.86,177,190.86" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[099b5375af2a518eb88faf65c454c670]
reverse link marlin.core.trainer_backend.SingleProcessAmp to marlin.core.trainer_backend.SingleProcess--><path codeLine="176" d="M440.49,198.63 C442.67,231.28 445.19,268.97 446.92,294.83 " fill="none" id="marlin.core.trainer_backend.SingleProcessAmp-backto-marlin.core.trainer_backend.SingleProcess" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="433.5,199.01,439.15,178.58,447.47,198.07,433.5,199.01" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[9062feb34554d5b63c90d4c38e3ae080]
reverse link marlin.core.trainer.Trainer to UserModuleInterface--><path codeLine="177" d="M984.66,216.51 C986.44,217.36 988.22,218.19 990,219 C1078.71,259.44 1108.53,248.11 1201,279 C1208.43,281.48 1216.07,284.15 1223.73,286.9 " fill="none" id="marlin.core.trainer.Trainer-backto-UserModuleInterface" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="972.88,210.62,976.4577,216.881,983.6131,215.9866,980.0354,209.7256,972.88,210.62" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a4b7c9e636aea7d6067233859c44573a]
reverse link UserModuleInterface to transformers.AutoTokenizer--><path codeLine="179" d="M1221.88,384.05 C1215.27,390.99 1209.47,398.63 1205,407 C1114.25,576.96 1080.83,693.18 1205,840.5 C1256.86,902.03 1494.66,918.22 1617.32,922.48 " fill="none" id="UserModuleInterface-backto-transformers.AutoTokenizer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1231.38,375.01,1224.2769,376.2535,1222.6929,383.2885,1229.7959,382.045,1231.38,375.01" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[1490667d12056e87b17090143b05c306]
link marlin.core.data_interface.DataInterface to marlin.core.data_interface.DataProcessor--><path codeLine="180" d="M1895.26,825.31 C1895.62,845.7 1896,867.14 1896.31,884.8 " fill="none" id="marlin.core.data_interface.DataInterface-marlin.core.data_interface.DataProcessor" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[7d5c3ff2615fb71612e6c75b6e7d4e65]
reverse link UserModuleInterface to UserDataInterface--><path codeLine="181" d="M1435.25,338.55 C1514.97,348.94 1623.17,369.01 1712,407 C1747.51,422.19 1783.15,445.65 1812.26,467.47 " fill="none" id="UserModuleInterface-backto-UserDataInterface" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="1422.21,336.9,1427.6617,341.62,1434.1155,338.403,1428.6638,333.683,1422.21,336.9" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[678202947126a8c40f5488a75c224dd7]
reverse link marlin.core.trainer.Trainer to marlin.core.trainer.TrainerArgs--><path codeLine="183" d="M966.88,227.78 C987.33,245.53 1007.83,263.33 1025.65,278.8 " fill="none" id="marlin.core.trainer.Trainer-backto-marlin.core.trainer.TrainerArgs" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="956.86,219.08,958.7702,226.0335,965.9235,226.9447,964.0133,219.9912,956.86,219.08" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[95a70b87dd502b4148687948f76d63c3]
link UserDataProcessor to UserDataInterface--><path codeLine="185" d="M1885.05,351.08 C1883.88,379.55 1881.85,428.92 1880.27,467.39 " fill="none" id="UserDataProcessor-UserDataInterface" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[1fdd14434ccb59478c5830fd9e385bc7]
reverse link UserDataProcessor to marlin.core.data_interface.DataProcessor--><path codeLine="186" d="M1946.25,362.8 C1961.37,374.73 1975.66,389.55 1984,407 C2067.14,580.81 2059.55,663.27 1984,840.5 C1976.86,857.25 1964.52,872.27 1951.35,884.78 " fill="none" id="UserDataProcessor-backto-marlin.core.data_interface.DataProcessor" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1941.95,368.33,1929.75,351,1950.09,356.94,1941.95,368.33" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[aefeea6feecf3eae37d886d586a9d982]
link transformers.AutoModel to transformers.AutoTokenizer--><!--MD5=[958d404b25592d540e3191bac660be0e]
link marlin.core.utils.checkpoint_utils.Checkpoint to marlin.core.utils.checkpoint_utils.AbstractCheckpointer--><path codeLine="190" d="M996.24,571.53 C997.27,610.36 998.72,665.22 999.75,704.14 " fill="none" id="marlin.core.utils.checkpoint_utils.Checkpoint-marlin.core.utils.checkpoint_utils.AbstractCheckpointer" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[12e6ae56096c326bdfbd49dbdbbb3157]
reverse link marlin.core.utils.checkpoint_utils.DefaultCheckpointer to marlin.core.utils.checkpoint_utils.AbstractCheckpointer--><path codeLine="191" d="M791.82,567.47 C819.34,587.55 851.92,612.24 880,636 C905.38,657.48 932.27,682.85 954.23,704.33 " fill="none" id="marlin.core.utils.checkpoint_utils.DefaultCheckpointer-backto-marlin.core.utils.checkpoint_utils.AbstractCheckpointer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="787.52,573,775.42,555.61,795.73,561.66,787.52,573" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[5128b32269152b2c7466669e97edf4c7]
reverse link marlin.core.utils.checkpoint_utils.DefaultCheckpointer to marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments--><path codeLine="192" d="M729.45,568.61 C727.76,616.43 725.14,690.9 723.82,728.35 " fill="none" id="marlin.core.utils.checkpoint_utils.DefaultCheckpointer-backto-marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#FFFFFF" points="729.9,555.59,725.6914,561.4456,729.4778,567.5826,733.6864,561.727,729.9,555.59" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[a33255a1e195245542d4e5fc5a95119b]
reverse link marlin.core.trainer.Trainer to marlin.core.utils.checkpoint_utils.DefaultCheckpointer--><path codeLine="193" d="M788.06,230.85 C779.56,246.46 771.83,262.8 766,279 C739.76,351.94 733.14,443.85 731.5,491.17 " fill="none" id="marlin.core.trainer.Trainer-backto-marlin.core.utils.checkpoint_utils.DefaultCheckpointer" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="794.68,219.06,788.2523,222.3288,788.7975,229.5193,795.2252,226.2505,794.68,219.06" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[d7c81fb9d0958ec01c208775c88cb6c6]
link marlin.core.trainer.AbstractTrainer to marlin.core.utils.checkpoint_utils.Checkpoint--><!--MD5=[08e128ebdb1c9e89f5790b88fef17439]
reverse link marlin.models.auto.modeling_auto.MarlinAutoModel to transformers.AutoModel--><path codeLine="197" d="M1625.99,566.63 C1640.72,614.38 1664.18,690.48 1675.88,728.42 " fill="none" id="marlin.models.auto.modeling_auto.MarlinAutoModel-backto-transformers.AutoModel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="none" points="1619.3,568.69,1620.1,547.52,1632.68,564.56,1619.3,568.69" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[0a142f2545c2e6ee167fa691d1298b18]
reverse link UserModuleInterface to marlin.models.auto.modeling_auto.MarlinAutoModel--><path codeLine="198" d="M1404.09,382.39 C1461.57,420.94 1535.79,470.72 1578.53,499.38 " fill="none" id="UserModuleInterface-backto-marlin.models.auto.modeling_auto.MarlinAutoModel" style="stroke:#A80036;stroke-width:1.0;"/><polygon fill="#A80036" points="1393.2,375.08,1395.9512,381.7457,1403.1622,381.7699,1400.4111,375.1042,1393.2,375.08" style="stroke:#A80036;stroke-width:1.0;"/><!--MD5=[aa1b0728ccaeedfda0fbdb648e2d2e84]
@startuml classes

'Diagram visualization params
skinparam RoundCorner 10
skinparam class {
    AttributeFontColor #2b2b2b
    AttributeFontName Arial
    AttributeFontSize 14
    BackgroundColor #f6f7f9
    BorderColor #3f6184
    BorderThickness 2
    FontColor #f6f7f9
    FontName Arial
    FontSize 18
    HeaderBackgroundColor #3f6184
}

'Class diagram descriptions

'External classes
class torch.nn.Module {}
class transformers.AutoModel {}
class transformers.AutoTokenizer {}


'Marlin classes

'Marlin auto model
namespace marlin.models.auto.modeling_auto {
    class MarlinAutoModel 
}

'Module Interface
namespace marlin.core.module_interface {
    class CallbackInterface {
        on_end_train_step()
        on_end_train_epoch()
        on_end_backward()
        on_end_val_epoch()
        on_end_train()
    }
    abstract class ModuleInterface {
        forward()
        {abstract} get_optimizers_schedulers()
        {abstract} get_train_dataloader()
        {abstract} get_val_dataloaders()
        {abstract} train_step()
        {abstract} val_step()
    }
}

'Trainer Backend
namespace marlin.core.trainer_backend {
    abstract class TrainerBackend{
        {abstract} init()
        {abstract} train_dl()
        {abstract} validate_dl()
        {abstract} get_batches_completed()
        {abstract} get_global_steps_completed()
        {abstract} train_sampler()
        {abstract} val_sampler()
    }
    note right: Users can implement\ntheir own Trainers
    class SingleProcess {
        ModuleInterface model
    }
    class AbstractTrainerBackendDecorator
    class SingleProcessAmp {
        init()
        train_dl()
        validate_dl()
    }
    class DDPTrainerBackend{
        init()
        setup_distributed_model()
    }
}


'Trainer
namespace marlin.core.trainer {
    class TrainerArgs {
        DefaultCheckpointerArguments
        WriterInitArgs
        StatInitArgs
    }
    note top: Customize these and other\n args from config.yaml
    abstract class AbstractTrainer {
        {abstract} train()
        {abstract} validate()
    }
    class Trainer{
        TrainerBackend trainer_backend
        ModuleInterface module
        AbstractCheckpointer checkpointer
        optimizers
        schedulers

        train()
        validate()
        load_checkpoint()
    }
}

'Data interface
namespace marlin.core.data_interface {

    abstract class DataProcessor {
        analyze()
        {abstract} process()
    }
    abstract class DataInterface {
        setup_datasets()
        process_data()
        multi_process_data()
        {abstract} get_train_dataset()
        {abstract} get_val_dataset()
        {abstract} get_test_dataset()
    }
}

'Checkpointer
namespace marlin.core.utils.checkpoint_utils{

    class Checkpoint{
        Dict module_interface_state
        Dict trainer_state
        Dict trainer_backend_state
    }

    abstract class AbstractCheckpointer{
        {abstract} save()
        {abstract} save_model()
        {abstract} load()

    } 
    class DefaultCheckpointer{
        DefaultCheckpointerArguments args
    }
}

'Scenario classes
class UserModuleInterface {
    DataInterface data
    MarlinAutoModel model
    AutoTokenizer tokenizer
}
note top: Training recipe - scenario specific\n and implemented by user


class UserDataInterface {

    setup_datasets()
    get_train_dataset()
    get_val_dataset()
    get_test_dataset()
}

together {

    class UserDataProcessor {}
    note top: Implements how to load\nand process your data
    class marlin.core.data_interface.DataProcessor{}
}



marlin.core.module_interface.ModuleInterface <|- - marlin.core.module_interface.CallbackInterface
marlin.core.module_interface.ModuleInterface <|- - torch.nn.Module
UserModuleInterface <|- - marlin.core.module_interface.ModuleInterface
UserDataInterface <|- - marlin.core.data_interface.DataInterface
marlin.core.trainer_backend.SingleProcess <|- - marlin.core.trainer_backend.TrainerBackend
marlin.core.trainer.Trainer <|- - marlin.core.trainer.AbstractTrainer
marlin.core.trainer.Trainer o- - marlin.core.trainer_backend.SingleProcess
marlin.core.trainer_backend.AbstractTrainerBackendDecorator <|- - marlin.core.trainer_backend.TrainerBackend
marlin.core.trainer_backend.DDPTrainerBackend <|- - marlin.core.trainer_backend.AbstractTrainerBackendDecorator
marlin.core.trainer_backend.SingleProcessAmp <|- - marlin.core.trainer_backend.SingleProcess
marlin.core.trainer.Trainer o- - UserModuleInterface
'UserModuleInterface *- - transformers.AutoModel
UserModuleInterface *- - transformers.AutoTokenizer
marlin.core.data_interface.DataInterface - - marlin.core.data_interface.DataProcessor
UserModuleInterface o- - UserDataInterface

marlin.core.trainer.Trainer o- - marlin.core.trainer.TrainerArgs

UserDataProcessor - - UserDataInterface
UserDataProcessor <|- marlin.core.data_interface.DataProcessor

transformers.AutoTokenizer -[hidden]up- transformers.AutoModel

marlin.core.utils.checkpoint_utils.Checkpoint - - marlin.core.utils.checkpoint_utils.AbstractCheckpointer
marlin.core.utils.checkpoint_utils.DefaultCheckpointer <|- - marlin.core.utils.checkpoint_utils.AbstractCheckpointer
marlin.core.utils.checkpoint_utils.DefaultCheckpointer o- - marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments
marlin.core.trainer.Trainer *- - marlin.core.utils.checkpoint_utils.DefaultCheckpointer

marlin.core.utils.checkpoint_utils.Checkpoint -[hidden]up- marlin.core.trainer.AbstractTrainer

marlin.models.auto.modeling_auto.MarlinAutoModel <|- - transformers.AutoModel
UserModuleInterface *- - marlin.models.auto.modeling_auto.MarlinAutoModel

@enduml

@startuml classes

skinparam RoundCorner 10
skinparam class {
    AttributeFontColor #2b2b2b
    AttributeFontName Arial
    AttributeFontSize 14
    BackgroundColor #f6f7f9
    BorderColor #3f6184
    BorderThickness 2
    FontColor #f6f7f9
    FontName Arial
    FontSize 18
    HeaderBackgroundColor #3f6184
}


class torch.nn.Module {}
class transformers.AutoModel {}
class transformers.AutoTokenizer {}



namespace marlin.models.auto.modeling_auto {
    class MarlinAutoModel 
}

namespace marlin.core.module_interface {
    class CallbackInterface {
        on_end_train_step()
        on_end_train_epoch()
        on_end_backward()
        on_end_val_epoch()
        on_end_train()
    }
    abstract class ModuleInterface {
        forward()
        {abstract} get_optimizers_schedulers()
        {abstract} get_train_dataloader()
        {abstract} get_val_dataloaders()
        {abstract} train_step()
        {abstract} val_step()
    }
}

namespace marlin.core.trainer_backend {
    abstract class TrainerBackend{
        {abstract} init()
        {abstract} train_dl()
        {abstract} validate_dl()
        {abstract} get_batches_completed()
        {abstract} get_global_steps_completed()
        {abstract} train_sampler()
        {abstract} val_sampler()
    }
    note right: Users can implement\ntheir own Trainers
    class SingleProcess {
        ModuleInterface model
    }
    class AbstractTrainerBackendDecorator
    class SingleProcessAmp {
        init()
        train_dl()
        validate_dl()
    }
    class DDPTrainerBackend{
        init()
        setup_distributed_model()
    }
}


namespace marlin.core.trainer {
    class TrainerArgs {
        DefaultCheckpointerArguments
        WriterInitArgs
        StatInitArgs
    }
    note top: Customize these and other\n args from config.yaml
    abstract class AbstractTrainer {
        {abstract} train()
        {abstract} validate()
    }
    class Trainer{
        TrainerBackend trainer_backend
        ModuleInterface module
        AbstractCheckpointer checkpointer
        optimizers
        schedulers

        train()
        validate()
        load_checkpoint()
    }
}

namespace marlin.core.data_interface {

    abstract class DataProcessor {
        analyze()
        {abstract} process()
    }
    abstract class DataInterface {
        setup_datasets()
        process_data()
        multi_process_data()
        {abstract} get_train_dataset()
        {abstract} get_val_dataset()
        {abstract} get_test_dataset()
    }
}

namespace marlin.core.utils.checkpoint_utils{

    class Checkpoint{
        Dict module_interface_state
        Dict trainer_state
        Dict trainer_backend_state
    }

    abstract class AbstractCheckpointer{
        {abstract} save()
        {abstract} save_model()
        {abstract} load()

    } 
    class DefaultCheckpointer{
        DefaultCheckpointerArguments args
    }
}

class UserModuleInterface {
    DataInterface data
    MarlinAutoModel model
    AutoTokenizer tokenizer
}
note top: Training recipe - scenario specific\n and implemented by user


class UserDataInterface {

    setup_datasets()
    get_train_dataset()
    get_val_dataset()
    get_test_dataset()
}

together {

    class UserDataProcessor {}
    note top: Implements how to load\nand process your data
    class marlin.core.data_interface.DataProcessor{}
}



marlin.core.module_interface.ModuleInterface <|- - marlin.core.module_interface.CallbackInterface
marlin.core.module_interface.ModuleInterface <|- - torch.nn.Module
UserModuleInterface <|- - marlin.core.module_interface.ModuleInterface
UserDataInterface <|- - marlin.core.data_interface.DataInterface
marlin.core.trainer_backend.SingleProcess <|- - marlin.core.trainer_backend.TrainerBackend
marlin.core.trainer.Trainer <|- - marlin.core.trainer.AbstractTrainer
marlin.core.trainer.Trainer o- - marlin.core.trainer_backend.SingleProcess
marlin.core.trainer_backend.AbstractTrainerBackendDecorator <|- - marlin.core.trainer_backend.TrainerBackend
marlin.core.trainer_backend.DDPTrainerBackend <|- - marlin.core.trainer_backend.AbstractTrainerBackendDecorator
marlin.core.trainer_backend.SingleProcessAmp <|- - marlin.core.trainer_backend.SingleProcess
marlin.core.trainer.Trainer o- - UserModuleInterface
UserModuleInterface *- - transformers.AutoTokenizer
marlin.core.data_interface.DataInterface - - marlin.core.data_interface.DataProcessor
UserModuleInterface o- - UserDataInterface

marlin.core.trainer.Trainer o- - marlin.core.trainer.TrainerArgs

UserDataProcessor - - UserDataInterface
UserDataProcessor <|- marlin.core.data_interface.DataProcessor

transformers.AutoTokenizer -[hidden]up- transformers.AutoModel

marlin.core.utils.checkpoint_utils.Checkpoint - - marlin.core.utils.checkpoint_utils.AbstractCheckpointer
marlin.core.utils.checkpoint_utils.DefaultCheckpointer <|- - marlin.core.utils.checkpoint_utils.AbstractCheckpointer
marlin.core.utils.checkpoint_utils.DefaultCheckpointer o- - marlin.core.utils.checkpoint_utils.DefaultCheckpointerArguments
marlin.core.trainer.Trainer *- - marlin.core.utils.checkpoint_utils.DefaultCheckpointer

marlin.core.utils.checkpoint_utils.Checkpoint -[hidden]up- marlin.core.trainer.AbstractTrainer

marlin.models.auto.modeling_auto.MarlinAutoModel <|- - transformers.AutoModel
UserModuleInterface *- - marlin.models.auto.modeling_auto.MarlinAutoModel

@enduml

PlantUML version 1.2021.00(Sun Jan 10 07:25:05 CLST 2021)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) Client VM
Default Encoding: Cp1252
Language: en
Country: US
--></g></svg>